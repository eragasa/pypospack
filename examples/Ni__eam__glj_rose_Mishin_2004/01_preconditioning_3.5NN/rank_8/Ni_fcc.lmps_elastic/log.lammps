LAMMPS (11 Aug 2017)
include init.mod
# ---- init.mod file
variable up equal 1.0e-6
units metal
dimension 3
boundary p p p
atom_style atomic
atom_modify map array
variable cfac equal 1.0e-4
variable cunits string GPa
# ---- define minimization parameters
variable etol equal 0.0
variable ftol equal 1.0e-10
variable maxiter equal 100
variable maxeval equal 1000
variable dmax equal 1.0e-2
# --- read data structure
read_data lammps.structure
  triclinic box = (0 0 0) to (3.5167 3.5167 3.5167) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no
# ---- Compute initial state
fix 3 all box/relax aniso 0.0
minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
       0            0   -18.100341    23359.643    23359.643    23359.643    23359.643 1.5240811e-10 1.2972148e-10 -1.7553363e-10       3.5167       3.5167       3.5167    43.491658 
       1            0   -18.100529     22773.49     22773.49     22773.49     22773.49 3.0886137e-10 -3.0108715e-10 3.2699104e-10    3.5170517    3.5170517    3.5170517    43.504707 
       2            0   -18.100712      22186.2      22186.2      22186.2      22186.2 -1.6223729e-10 -1.2248506e-10 -1.3707394e-10    3.5174033    3.5174033    3.5174033    43.517758 
       3            0    -18.10089    21596.573    21596.573    21596.573    21596.573 -1.2530757e-10 -1.5689898e-10 -1.7240282e-10     3.517755     3.517755     3.517755    43.530812 
       4            0   -18.101064    21004.619    21004.619    21004.619    21004.619 -3.9894977e-12 -3.3472639e-11 -4.3589556e-11    3.5181067    3.5181067    3.5181067    43.543869 
       5            0   -18.101233     20411.88     20411.88     20411.88     20411.88 1.4566623e-10 1.518972e-10 1.3561747e-10    3.5184583    3.5184583    3.5184583    43.556928 
       6            0   -18.101397    19825.565    19825.565    19825.565    19825.565 5.3352265e-11 1.9149919e-11 2.6701351e-11      3.51881      3.51881      3.51881     43.56999 
       7            0   -18.101556    19246.021    19246.021    19246.021    19246.021 -1.6741099e-10 -1.8957266e-10 -2.0668028e-10    3.5191617    3.5191617    3.5191617    43.583054 
       8            0    -18.10171    18673.139    18673.139    18673.139    18673.139 -2.488399e-11 -5.2806948e-13 -7.2321612e-13    3.5195134    3.5195134    3.5195134    43.596122 
       9            0    -18.10186    18099.611    18099.611    18099.611    18099.611 -1.4424682e-11 2.1436575e-11 3.0948717e-11     3.519865     3.519865     3.519865    43.609191 
      10            0   -18.102006    17520.732    17520.732    17520.732    17520.732 -3.5859867e-11 7.3814492e-12 6.4684588e-12    3.5202167    3.5202167    3.5202167    43.622263 
      11            0   -18.102146    16936.532    16936.532    16936.532    16936.532 1.5344147e-10 1.8758667e-10 3.1970636e-10    3.5205684    3.5205684    3.5205684    43.635338 
      12            0   -18.102282    16348.705    16348.705    16348.705    16348.705 1.5284894e-11 3.493246e-11 2.2342657e-11      3.52092      3.52092      3.52092    43.648416 
      13            0   -18.102413    15763.796    15763.796    15763.796    15763.796 -2.4347038e-11 2.8905596e-11 2.6709978e-11    3.5212717    3.5212717    3.5212717    43.661496 
      14            0    -18.10254    15180.922    15180.922    15180.922    15180.922 -7.8981124e-12 2.7404443e-12 4.9789989e-12    3.5216234    3.5216234    3.5216234    43.674579 
      15            0   -18.102661    14600.081    14600.081    14600.081    14600.081 1.1345981e-11 1.135033e-11 3.8122808e-12     3.521975     3.521975     3.521975    43.687664 
      16            0   -18.102778    14019.113    14019.113    14019.113    14019.113 4.4538047e-11 2.5373817e-11 3.3854995e-11    3.5223267    3.5223267    3.5223267    43.700752 
      17            0    -18.10289     13441.54     13441.54     13441.54     13441.54 -1.1283271e-10 -1.4448325e-10 -1.3745668e-10    3.5226784    3.5226784    3.5226784    43.713843 
      18            0   -18.102998    12869.942    12869.942    12869.942    12869.942 -3.1664908e-10 -3.3260316e-10 3.2597375e-10    3.5230301    3.5230301    3.5230301    43.726936 
      19            0   -18.103101      12304.3      12304.3      12304.3      12304.3 5.3426862e-12 2.3790309e-11 1.7009269e-11    3.5233817    3.5233817    3.5233817    43.740032 
      20            0   -18.103199    11742.369    11742.369    11742.369    11742.369 -2.1740367e-10 -1.903582e-10 -2.7724455e-11    3.5237334    3.5237334    3.5237334     43.75313 
      21            0   -18.103293    11174.144    11174.144    11174.144    11174.144 2.9435835e-11 4.2978602e-11 4.514667e-11    3.5240851    3.5240851    3.5240851    43.766231 
      22            0   -18.103382    10598.815    10598.815    10598.815    10598.815 1.0496329e-11 -1.2753195e-11 1.3042752e-11    3.5244367    3.5244367    3.5244367    43.779335 
      23            0   -18.103466    10016.417    10016.417    10016.417    10016.417 -5.7580169e-11 -1.9917183e-11 1.9225859e-11    3.5247884    3.5247884    3.5247884    43.792441 
      24            0   -18.103546    9435.1884    9435.1884    9435.1884    9435.1884 1.6750436e-10 -1.4780109e-10 -1.7801108e-10    3.5251401    3.5251401    3.5251401     43.80555 
      25            0   -18.103621    8859.6892    8859.6892    8859.6892    8859.6892 3.2845095e-11 -1.8905204e-11 4.8314816e-12    3.5254917    3.5254917    3.5254917    43.818662 
      26            0   -18.103691    8289.8429    8289.8429    8289.8429    8289.8429 2.1143829e-10 1.6768841e-10 1.5806903e-10    3.5258434    3.5258434    3.5258434    43.831776 
      27            0   -18.103756    7724.4606    7724.4606    7724.4606    7724.4606 -2.7674107e-11 -3.2303908e-11 -4.4822591e-11    3.5261951    3.5261951    3.5261951    43.844892 
      28            0   -18.103817    7157.6549    7157.6549    7157.6549    7157.6549 -3.4722709e-12 -3.3411919e-11 -4.2904613e-11    3.5265468    3.5265468    3.5265468    43.858012 
      29            0   -18.103874    6594.2936    6594.2936    6594.2936    6594.2936 -2.1243907e-10 -2.0130617e-10 1.5338827e-10    3.5268984    3.5268984    3.5268984    43.871134 
      30            0   -18.103925    6034.3652    6034.3652    6034.3652    6034.3652 1.2185251e-11 2.5850701e-11 3.1460844e-11    3.5272501    3.5272501    3.5272501    43.884258 
      31            0   -18.103972    5479.2857    5479.2857    5479.2857    5479.2857 4.9341209e-11 -5.43687e-12 2.2391181e-11    3.5276018    3.5276018    3.5276018    43.897386 
      32            0   -18.104015    4919.5637    4919.5637    4919.5637    4919.5637 6.5914661e-11 2.5911473e-11 6.1254052e-13    3.5279534    3.5279534    3.5279534    43.910515 
      33            0   -18.104053     4347.602     4347.602     4347.602     4347.602 1.9495493e-11 -2.5791802e-11 -1.306347e-11    3.5283051    3.5283051    3.5283051    43.923648 
      34            0   -18.104086    3763.4539    3763.4539    3763.4539    3763.4539 -5.6770098e-12 2.3223628e-11 2.231773e-11    3.5286568    3.5286568    3.5286568    43.936783 
      35            0   -18.104115    3171.5139    3171.5139    3171.5139    3171.5139 1.8139717e-10 1.1745651e-10 -2.1561608e-10    3.5290084    3.5290084    3.5290084    43.949921 
      36            0   -18.104138    2588.6468    2588.6468    2588.6468    2588.6468 -1.8438316e-11 8.0943027e-12 4.058931e-11    3.5293601    3.5293601    3.5293601    43.963061 
      37            0   -18.104157    2016.3148    2016.3148    2016.3148    2016.3148 1.363049e-11 -2.2001408e-11 -3.3339973e-11    3.5297118    3.5297118    3.5297118    43.976204 
      38            0   -18.104171     1454.477     1454.477     1454.477     1454.477 -1.5163029e-10 -5.7952478e-12 -2.3885988e-11    3.5300635    3.5300635    3.5300635    43.989349 
      39            0   -18.104181    895.67676    895.67676    895.67676    895.67676 2.8631665e-10 -8.8008867e-13 5.3143033e-12    3.5304151    3.5304151    3.5304151    44.002498 
      40            0   -18.104186    337.07578    337.07578    337.07578    337.07578 -3.307944e-11 -2.2049738e-11 3.1637776e-12    3.5307668    3.5307668    3.5307668    44.015648 
      41            0   -18.104187   -6.0048308   -6.0048308   -6.0048308   -6.0048308 1.5322184e-10 -4.9206964e-11 -6.8191499e-11    3.5309834    3.5309834    3.5309834    44.023751 
      42            0   -18.104232   -98.993332   -98.993332   -98.993332   -98.993332 7.0128985e-11 3.6859306e-10 -1.9793991e-10     3.531043     3.531043     3.531043    44.025978 
      43            0   -18.114218   -390.52143   -390.52143   -390.52143   -390.52143 -6.9018902e-11 -1.98946e-10 -1.5762765e-10    3.5313947    3.5313947    3.5313947    44.039134 
      44            0   -18.142842   -186.58756   -186.58756   -186.58756   -186.58756 -3.9457229e-10 2.197336e-10 3.8177661e-10    3.5317463    3.5317463    3.5317463    44.052292 
      45            0   -18.170764     1199.023     1199.023     1199.023     1199.023 -6.7032344e-10 -2.3713481e-10 1.3220263e-09    3.5313947    3.5313947    3.5313947    44.039134 
      46            0   -18.180208    895.60087    895.60087    895.60087    895.60087 -4.6094332e-10 1.1283069e-10 1.5933963e-09    3.5317463    3.5317463    3.5317463    44.052292 
      47            0   -18.190445    613.73723    613.73723    613.73723    613.73723 -1.2454673e-09 5.1896646e-10 1.5600405e-09     3.532098     3.532098     3.532098    44.065453 
      48            0   -18.207031     497.6451     497.6451     497.6451     497.6451 1.4674864e-10 3.625244e-10 1.2414113e-09    3.5324497    3.5324497    3.5324497    44.078616 
      49            0   -18.231738    577.87608    577.87608    577.87608    577.87608 -5.5870901e-10 4.5991846e-10 9.3125468e-10    3.5328013    3.5328013    3.5328013    44.091782 
      50            0   -18.258991    737.85147    737.85147    737.85147    737.85147 -1.3032865e-09 6.3478226e-10 2.0941337e-09     3.533153     3.533153     3.533153     44.10495 
      51            0   -18.285051    875.64162    875.64162    875.64162    875.64162 -6.6525105e-10 3.9390268e-10 2.9001899e-09    3.5335047    3.5335047    3.5335047    44.118122 
      52            0   -18.310452    1014.9258    1014.9258    1014.9258    1014.9258 -7.7786442e-10 1.2111959e-09 2.2956694e-09    3.5338564    3.5338564    3.5338564    44.131295 
      53            0   -18.335318    1108.6933    1108.6933    1108.6933    1108.6933 -1.4369665e-09 1.0711867e-09 2.3905696e-09     3.534208     3.534208     3.534208    44.144472 
      54            0   -18.360714    1204.5934    1204.5934    1204.5934    1204.5934 -5.3671569e-10 9.0876856e-10 2.8426274e-09    3.5345597    3.5345597    3.5345597    44.157651 
      55            0   -18.386644    1338.5739    1338.5739    1338.5739    1338.5739 -1.3822119e-09 9.5892985e-10 2.1047204e-09    3.5349114    3.5349114    3.5349114    44.170833 
      56            0   -18.412357    1470.6213    1470.6213    1470.6213    1470.6213 -1.5631083e-09 1.0410009e-09 2.6168828e-09     3.535263     3.535263     3.535263    44.184017 
      57            0   -18.437878      1601.41      1601.41      1601.41      1601.41 -1.3667759e-09 6.5085429e-10 2.5288606e-09    3.5356147    3.5356147    3.5356147    44.197204 
      58            0   -18.463253    1701.8575    1701.8575    1701.8575    1701.8575 -2.5198006e-09 8.1505035e-10 2.4706887e-09    3.5359664    3.5359664    3.5359664    44.210393 
      59            0   -18.488944    1809.0369    1809.0369    1809.0369    1809.0369 -1.6194082e-09 1.1468788e-09 3.1269988e-09     3.536318     3.536318     3.536318    44.223585 
      60            0    -18.51484    1947.7177    1947.7177    1947.7177    1947.7177 -2.2815569e-09 1.1751263e-09 3.5630606e-09    3.5366697    3.5366697    3.5366697     44.23678 
      61            0   -18.540564    2070.7867    2070.7867    2070.7867    2070.7867 -1.8626129e-09 1.5600718e-09 3.1161413e-09    3.5370214    3.5370214    3.5370214    44.249978 
      62            0   -18.566292     2186.747     2186.747     2186.747     2186.747  -1.9838e-09 7.7509745e-10 3.6094667e-09    3.5373731    3.5373731    3.5373731    44.263178 
      63            0   -18.592117    2305.1563    2305.1563    2305.1563    2305.1563 -1.6652229e-09 9.381158e-10 3.3131576e-09    3.5377247    3.5377247    3.5377247     44.27638 
      64            0   -18.618012    2431.6179    2431.6179    2431.6179    2431.6179 -1.6029688e-09 1.5878865e-09 3.3280613e-09    3.5380764    3.5380764    3.5380764    44.289586 
      65            0   -18.643895    2569.6803    2569.6803    2569.6803    2569.6803 -2.2641208e-09 1.0789889e-09 3.577905e-09    3.5384281    3.5384281    3.5384281    44.302794 
      66            0   -18.669652    2672.5033    2672.5033    2672.5033    2672.5033 -2.028599e-09 1.5504471e-09 4.4660247e-09    3.5387797    3.5387797    3.5387797    44.316004 
      67            0   -18.695626    2781.0343    2781.0343    2781.0343    2781.0343 -2.2230779e-09 1.6342349e-09 4.5502008e-09    3.5391314    3.5391314    3.5391314    44.329217 
      68            0   -18.721769    2938.1942    2938.1942    2938.1942    2938.1942 -2.0076655e-09 1.4928262e-09 3.6890765e-09    3.5394831    3.5394831    3.5394831    44.342433 
      69            0   -18.747647    3050.3415    3050.3415    3050.3415    3050.3415 -2.1418116e-09 1.3413696e-09 4.2132282e-09    3.5398347    3.5398347    3.5398347    44.355651 
      70            0   -18.773646    3154.7404    3154.7404    3154.7404    3154.7404 -2.2685684e-09 1.9677984e-09 4.0721316e-09    3.5401864    3.5401864    3.5401864    44.368873 
      71            0   -18.799835    3366.5796    3366.5796    3366.5796    3366.5796 -2.1986411e-09 1.5422534e-09 4.9365397e-09    3.5405381    3.5405381    3.5405381    44.382096 
      72            0   -18.825378    3539.6376    3539.6376    3539.6376    3539.6376 -2.2868888e-09 1.8588813e-09 4.3302102e-09    3.5408898    3.5408898    3.5408898    44.395322 
      73            0   -18.850587    3670.9235    3670.9235    3670.9235    3670.9235 -2.36818e-09 2.1579065e-09 4.6948395e-09    3.5412414    3.5412414    3.5412414    44.408551 
      74            0    -18.87577    3755.0301    3755.0301    3755.0301    3755.0301 -2.8031115e-09 1.9847077e-09 4.8822744e-09    3.5415931    3.5415931    3.5415931    44.421783 
      75            0    -18.90125    3838.6916    3838.6916    3838.6916    3838.6916 -2.533961e-09 1.9905185e-09 4.4479347e-09    3.5419448    3.5419448    3.5419448    44.435017 
      76            0   -18.927037    3981.9904    3981.9904    3981.9904    3981.9904 -2.6710741e-09 1.6012184e-09 5.2120731e-09    3.5422964    3.5422964    3.5422964    44.448254 
      77            0   -18.952742    4099.9689    4099.9689    4099.9689    4099.9689 -2.4393455e-09 1.6074714e-09 4.7204326e-09    3.5426481    3.5426481    3.5426481    44.461493 
      78            0    -18.97852    4203.6734    4203.6734    4203.6734    4203.6734 -2.3619282e-09 1.7903007e-09 5.0703427e-09    3.5429998    3.5429998    3.5429998    44.474735 
      79            0   -19.004463     4328.697     4328.697     4328.697     4328.697 -2.9638522e-09 1.8728034e-09 4.9542535e-09    3.5433514    3.5433514    3.5433514     44.48798 
      80            0   -19.030442    4450.2849    4450.2849    4450.2849    4450.2849 -2.8214087e-09 1.8169376e-09 5.4743865e-09    3.5437031    3.5437031    3.5437031    44.501227 
      81            0   -19.056476    4566.3991    4566.3991    4566.3991    4566.3991 -2.5159853e-09 1.3130294e-09 4.798494e-09    3.5440548    3.5440548    3.5440548    44.514477 
      82            0   -19.082599     4681.309     4681.309     4681.309     4681.309 -2.5756175e-09 2.528374e-09 5.8140451e-09    3.5444065    3.5444065    3.5444065     44.52773 
      83            0   -19.108817     4805.834     4805.834     4805.834     4805.834 -2.2340639e-09 1.8593885e-09 5.3032805e-09    3.5447581    3.5447581    3.5447581    44.540985 
      84            0   -19.135077    4961.1695    4961.1695    4961.1695    4961.1695 -2.6830081e-09 1.4827089e-09 5.846433e-09    3.5451098    3.5451098    3.5451098    44.554243 
      85            0   -19.161217    5060.8817    5060.8817    5060.8817    5060.8817 -2.9488077e-09 2.0818391e-09 5.2773237e-09    3.5454615    3.5454615    3.5454615    44.567504 
      86            0   -19.187527    5156.6079    5156.6079    5156.6079    5156.6079 -2.6691025e-09 2.2651676e-09 6.1077939e-09    3.5458131    3.5458131    3.5458131    44.580767 
      87            0   -19.214029    5284.0061    5284.0061    5284.0061    5284.0061 -2.6404481e-09 1.8277746e-09 6.4810767e-09    3.5461648    3.5461648    3.5461648    44.594032 
      88            0   -19.240564    5513.8615    5513.8615    5513.8615    5513.8615 -3.3293866e-09 2.5771418e-09 5.8182869e-09    3.5465165    3.5465165    3.5465165    44.607301 
      89            0   -19.266635    5764.1891    5764.1891    5764.1891    5764.1891 -2.6652059e-09 1.7400366e-09 6.2121677e-09    3.5468681    3.5468681    3.5468681    44.620572 
      90            0   -19.292165    5827.6308    5827.6308    5827.6308    5827.6308 -3.1583897e-09 1.9452844e-09 5.6541746e-09    3.5472198    3.5472198    3.5472198    44.633845 
      91            0   -19.318009    5925.3559    5925.3559    5925.3559    5925.3559 -3.0804948e-09 2.0532182e-09 6.3870078e-09    3.5475715    3.5475715    3.5475715    44.647122 
      92            0   -19.344017    6063.6855    6063.6855    6063.6855    6063.6855 -2.878144e-09 2.0466872e-09 6.3006597e-09    3.5479232    3.5479232    3.5479232    44.660401 
      93            0   -19.370012    6168.4691    6168.4691    6168.4691    6168.4691 -2.7735606e-09 2.1992761e-09 6.6102343e-09    3.5482748    3.5482748    3.5482748    44.673682 
      94            0   -19.396136    6282.6052    6282.6052    6282.6052    6282.6052 -3.4278295e-09 2.2789126e-09 7.0139395e-09    3.5486265    3.5486265    3.5486265    44.686966 
      95            0   -19.422349    6418.0473    6418.0473    6418.0473    6418.0473 -2.7942756e-09 2.3757859e-09 7.3088774e-09    3.5489782    3.5489782    3.5489782    44.700253 
      96            0   -19.448565    6520.7596    6520.7596    6520.7596    6520.7596 -3.069072e-09 1.9953876e-09 6.2018796e-09    3.5493298    3.5493298    3.5493298    44.713542 
      97            0   -19.474916    6630.3163    6630.3163    6630.3163    6630.3163 -3.8663224e-09 1.7720946e-09 6.8173564e-09    3.5496815    3.5496815    3.5496815    44.726834 
      98            0   -19.501376    6781.5063    6781.5063    6781.5063    6781.5063 -3.0407173e-09 2.6131639e-09 7.3535475e-09    3.5500332    3.5500332    3.5500332    44.740129 
      99            0   -19.527779    6880.8011    6880.8011    6880.8011    6880.8011 -3.027717e-09 2.0975579e-09 6.6469385e-09    3.5503848    3.5503848    3.5503848    44.753427 
     100            0   -19.554328    6986.5992    6986.5992    6986.5992    6986.5992 -2.8525084e-09 2.4318049e-09 6.1943611e-09    3.5507365    3.5507365    3.5507365    44.766726 
Loop time of 0.010951 on 1 procs for 100 steps with 4 atoms

99.2% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
        -18.1003408132      -19.527779214     -19.5543278079
  Force two-norm initial, final = 1.0983 7.16304
  Force max component initial, final = 0.634106 2.06553
  Final line search alpha, max atom move = 0.000519927 0.00107392
  Iterations, force evaluations = 100 101

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0068777  | 0.0068777  | 0.0068777  |   0.0 | 62.80
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00085139 | 0.00085139 | 0.00085139 |   0.0 |  7.77
Output  | 0.00083661 | 0.00083661 | 0.00083661 |   0.0 |  7.64
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.002385   |            |       | 21.78

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1684 ave 1684 max 1684 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1060 ave 1060 max 1060 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1060
Ave neighs/atom = 265
Neighbor list builds = 0
Dangerous builds = 0

variable tmp equal pxx
variable pxx0 equal ${tmp}
variable pxx0 equal 6986.59920277207
variable tmp equal pyy
variable pyy0 equal ${tmp}
variable pyy0 equal 6986.59920259116
variable tmp equal pzz
variable pzz0 equal ${tmp}
variable pzz0 equal 6986.59920275464
variable tmp equal pyz
variable pyz0 equal ${tmp}
variable pyz0 equal 6.19436109506192e-09
variable tmp equal pxz
variable pxz0 equal ${tmp}
variable pxz0 equal 2.43180486421112e-09
variable tmp equal pxy
variable pxy0 equal ${tmp}
variable pxy0 equal -2.85250835863211e-09

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 3.55073651227163
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 3.5507365122709
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 3.55073651227262

 # ---- define the derivatives w.r.t. strain components
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-6986.59920277207)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-6986.59920277207)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-6986.59920259116)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-6986.59920259116)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-6986.59920275464)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-6986.59920275464)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-6.19436109506192e-09)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-6.19436109506192e-09)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-2.43180486421112e-09)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-2.43180486421112e-09)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--2.85250835863211e-09)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--2.85250835863211e-09)/(v_delta/v_len0)*0.0001

# ---- write restart files
unfix 3
write_restart restart.equil
# ---- uxx Perturbation
variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 3.55073651227163
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*3.55073651227163
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
change_box all x delta 0 ${delta} remap units box
change_box all x delta 0 -3.55073651227163e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53371 3.53372 3.53372) with tilt (0 -0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328     6988.451    6988.2759    6988.5386    6988.5386 -3.4634911e-09 1.6341704e-09 6.5390262e-09     3.550733    3.5507365    3.5507365    44.766682 
     101            0   -23.226762    107393.53    107393.53    107393.52    107393.52 -6.3844907e-09 3.7495504e-09 1.2574072e-08     3.550733    3.5507365    3.5507365    44.766682 
     102            0   -29.245068    293074.93    293075.31    293074.73    293074.73 -4.0444411e-09 1.9922432e-09 8.9114416e-09     3.550733    3.5507365    3.5507365    44.766682 
     103            0   -36.534906    565091.75    565092.46    565091.39    565091.39 -2.8815459e-09 2.8065181e-09 5.9822612e-09     3.550733    3.5507365    3.5507365    44.766682 
     104            0   -42.718745    859270.34    859270.75    859270.13    859270.13 1.1484665e-09 -3.9693586e-09 -3.519158e-09     3.550733    3.5507365    3.5507365    44.766682 
     105            0   -46.073897    1015454.8    1015453.3    1015455.6    1015455.6 1.7521062e-08 -1.1571543e-08 -4.1137259e-08     3.550733    3.5507365    3.5507365    44.766682 
     106            0   -50.701117    890870.97    890867.58    890872.66    890872.66 1.166761e-07 -3.954111e-08 -1.683126e-07     3.550733    3.5507365    3.5507365    44.766682 
     107            0   -78.389315    713382.87    713466.11    713341.25    713341.25 -8.8842837e-08 4.9529179e-08 1.9840563e-07     3.550733    3.5507365    3.5507365    44.766682 
     108            0   -83.285885    1166577.5    1166604.9    1166563.8    1166563.8 -1.6200204e-07 7.5515692e-08 3.4155783e-07     3.550733    3.5507365    3.5507365    44.766682 
     109            0   -83.861726    1051522.7    1051566.8    1051500.7    1051500.7 -7.9751373e-08 4.1405804e-08 1.7483833e-07     3.550733    3.5507365    3.5507365    44.766682 
     110            0   -83.869523    1039520.6    1039558.1    1039501.9    1039501.9 -4.8735039e-08 1.6240005e-08 1.0001456e-07     3.550733    3.5507365    3.5507365    44.766682 
     111            0   -83.869769    1037796.3    1037828.7    1037780.2    1037780.2 -4.1407164e-08 2.0409541e-08 7.3575428e-08     3.550733    3.5507365    3.5507365    44.766682 
     112            0   -83.869808    1037009.9    1037036.9    1036996.4    1036996.4 -1.924036e-08 1.3939246e-08 4.8010935e-08     3.550733    3.5507365    3.5507365    44.766682 
     113            0   -83.869809    1036952.9    1036978.6    1036940.1    1036940.1 -1.2955538e-08 1.5709511e-08 3.0612613e-08     3.550733    3.5507365    3.5507365    44.766682 
     114            0    -83.86981    1036872.2    1036895.7    1036860.4    1036860.4 -1.9284313e-08 5.319635e-09 3.0523966e-08     3.550733    3.5507365    3.5507365    44.766682 
     115            0    -83.86981    1036791.3    1036811.6    1036781.1    1036781.1 -8.4956609e-09 2.4702221e-09 2.2589867e-08     3.550733    3.5507365    3.5507365    44.766682 
     116            0    -83.86981    1036725.4    1036739.6    1036718.3    1036718.3 -6.2777918e-09 4.7045072e-09 1.1153062e-08     3.550733    3.5507365    3.5507365    44.766682 
     117            0    -83.86981    1036724.5    1036737.9    1036717.8    1036717.8 -9.6284583e-09 6.0746596e-10 -3.9935825e-10     3.550733    3.5507365    3.5507365    44.766682 
     118            0    -83.86981      1036744    1036754.8    1036738.6    1036738.6 -8.8649758e-11 6.5528169e-10 -3.7558304e-09     3.550733    3.5507365    3.5507365    44.766682 
     119            0    -83.86981      1036747      1036751    1036745.1    1036745.1 1.4295513e-11 -2.4059317e-09 1.009919e-08     3.550733    3.5507365    3.5507365    44.766682 
     120            0    -83.86981    1036744.7    1036748.2    1036742.9    1036742.9 -8.1325345e-11 7.2627976e-09 -3.8636191e-09     3.550733    3.5507365    3.5507365    44.766682 
     121            0    -83.86981    1036744.8      1036748    1036743.2    1036743.2 5.2304018e-11 -8.6950852e-09 6.0496649e-09     3.550733    3.5507365    3.5507365    44.766682 
     122            0    -83.86981    1036744.8      1036748    1036743.3    1036743.3 -7.4275386e-09 -1.3442409e-08 4.294565e-10     3.550733    3.5507365    3.5507365    44.766682 
     123            0    -83.86981    1036744.8      1036748    1036743.3    1036743.3 9.726454e-09 2.0426612e-08 -3.9570423e-09     3.550733    3.5507365    3.5507365    44.766682 
     124            0    -83.86981    1036744.8      1036748    1036743.3    1036743.3 1.2729402e-08 7.5364493e-09 1.0514121e-09     3.550733    3.5507365    3.5507365    44.766682 
     125            0    -83.86981    1036744.8      1036748    1036743.3    1036743.3 -2.0177857e-08 -1.2623682e-08 -3.6422519e-10     3.550733    3.5507365    3.5507365    44.766682 
Loop time of 0.00682092 on 1 procs for 25 steps with 4 atoms

100.0% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543276127     -83.8698104223     -83.8698104223
  Force two-norm initial, final = 7.1552 1.01055e-11
  Force max component initial, final = 2.06553 5.41078e-12
  Final line search alpha, max atom move = 1 5.41078e-12
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0056996  | 0.0056996  | 0.0056996  |   0.0 | 83.56
Neigh   | 9.7036e-05 | 9.7036e-05 | 9.7036e-05 |   0.0 |  1.42
Comm    | 0.00066566 | 0.00066566 | 0.00066566 |   0.0 |  9.76
Output  | 0.00021601 | 0.00021601 | 0.00021601 |   0.0 |  3.17
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001426  |            |       |  2.09

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036748.01808864
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036743.25747207
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036743.25746976
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.01778574037203e-08
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1.26236820470277e-08
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -3.64225189848791e-10

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 102976141.888587
variable C2neg equal ${d2}
variable C2neg equal 102975665.826948
variable C3neg equal ${d3}
variable C3neg equal 102975665.826701
variable C4neg equal ${d4}
variable C4neg equal -6.55858628491071e-07
variable C5neg equal ${d5}
variable C5neg equal -1.50554869112388e-06
variable C6neg equal ${d6}
variable C6neg equal -1.73253490450882e-06

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*3.55073651227163
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
change_box all x delta 0 ${delta} remap units box
change_box all x delta 0 3.55073651227163e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328    6984.7475    6984.9227    6984.6599      6984.66 -3.2254427e-09 2.0583314e-09 6.9667852e-09    3.5507401    3.5507365    3.5507365    44.766771 
     101            0   -23.226764    107389.39    107389.38    107389.39    107389.39 -5.3086525e-09 3.7513923e-09 1.1524906e-08    3.5507401    3.5507365    3.5507365    44.766771 
     102            0   -29.245076    293067.93    293067.55    293068.13    293068.13 -3.2528139e-09 2.1842707e-09 9.1393905e-09    3.5507401    3.5507365    3.5507365    44.766771 
     103            0   -36.534927    565084.01     565083.3    565084.37    565084.37 -4.5292744e-09 -7.9399072e-11 4.6850909e-09    3.5507401    3.5507365    3.5507365    44.766771 
     104            0   -42.718787    859260.55    859260.14    859260.75    859260.75 -7.1279789e-10 -5.3431831e-10 -3.4610952e-09    3.5507401    3.5507365    3.5507365    44.766771 
     105            0   -46.073957    1015447.2    1015448.7    1015446.5    1015446.5 2.3642239e-08 -1.5698713e-08 -4.2747868e-08    3.5507401    3.5507365    3.5507365    44.766771 
     106            0   -50.701341    891037.06    891040.45    891035.37    891035.37 1.1127747e-07 -2.971369e-08 -2.0806952e-07    3.5507401    3.5507365    3.5507365    44.766771 
     107            0   -78.390823     713409.9    713326.65    713451.53    713451.53 -1.8768115e-07 1.0291142e-07 3.283668e-07    3.5507401    3.5507365    3.5507365    44.766771 
     108            0   -83.284937    1166686.8    1166659.3    1166700.5    1166700.5 -2.9402624e-07 1.5212436e-07 5.2453949e-07    3.5507401    3.5507365    3.5507365    44.766771 
     109            0   -83.861814    1051488.9    1051444.8    1051510.9    1051510.9 -1.5073052e-07 7.643396e-08 2.8612817e-07    3.5507401    3.5507365    3.5507365    44.766771 
     110            0   -83.869577    1039531.3    1039493.8      1039550      1039550 -8.6732109e-08 4.7828583e-08 1.5565025e-07    3.5507401    3.5507365    3.5507365    44.766771 
     111            0   -83.869826    1037804.2    1037771.8    1037820.4    1037820.4 -5.938838e-08 3.1864725e-08 1.1134901e-07    3.5507401    3.5507365    3.5507365    44.766771 
     112            0   -83.869866    1037011.5    1036984.5      1037025      1037025 -3.4092452e-08 2.2791802e-08 7.4918671e-08    3.5507401    3.5507365    3.5507365    44.766771 
     113            0   -83.869866    1036959.4    1036933.6    1036972.4    1036972.4 -3.5154165e-08 1.6869963e-08 7.1199816e-08    3.5507401    3.5507365    3.5507365    44.766771 
     114            0   -83.869868    1036882.4    1036858.5    1036894.3    1036894.3 -2.9868581e-08 1.4805516e-08 5.1313651e-08    3.5507401    3.5507365    3.5507365    44.766771 
     115            0   -83.869868    1036798.4    1036777.5    1036808.8    1036808.8 -2.3422602e-08 5.9561657e-09  3.27614e-08    3.5507401    3.5507365    3.5507365    44.766771 
     116            0   -83.869868    1036708.1    1036693.9    1036715.2    1036715.2 3.0876308e-09 1.5790999e-08 1.7063043e-08    3.5507401    3.5507365    3.5507365    44.766771 
     117            0   -83.869868    1036734.1    1036722.3      1036740      1036740 -4.3245999e-09 1.7642321e-09 9.8133176e-09    3.5507401    3.5507365    3.5507365    44.766771 
     118            0   -83.869868      1036743    1036735.5    1036746.8    1036746.8 -1.0450854e-09 -4.8191611e-09 -4.9385808e-09    3.5507401    3.5507365    3.5507365    44.766771 
     119            0   -83.869868    1036738.3    1036735.2    1036739.8    1036739.8 1.0532719e-08 2.8344462e-10 -9.4528435e-09    3.5507401    3.5507365    3.5507365    44.766771 
     120            0   -83.869868    1036738.4    1036735.4    1036739.9    1036739.9 -6.3846322e-09 -2.9995513e-10 -8.2160557e-10    3.5507401    3.5507365    3.5507365    44.766771 
     121            0   -83.869868    1036738.7    1036735.6    1036740.2    1036740.2  9.76238e-10  3.44904e-09 1.4300532e-09    3.5507401    3.5507365    3.5507365    44.766771 
     122            0   -83.869868    1036738.6    1036735.5    1036740.2    1036740.2 1.2745724e-08 -8.5935785e-09 7.4681135e-09    3.5507401    3.5507365    3.5507365    44.766771 
     123            0   -83.869868    1036738.6    1036735.5    1036740.2    1036740.2 3.1409988e-09 1.1740528e-08 -1.1326766e-08    3.5507401    3.5507365    3.5507365    44.766771 
     124            0   -83.869868    1036738.6    1036735.5    1036740.2    1036740.2 -2.2653999e-09 -1.1130182e-08 1.2449461e-08    3.5507401    3.5507365    3.5507365    44.766771 
     125            0   -83.869868    1036738.6    1036735.5    1036740.2    1036740.2 -2.1383895e-09 -2.8416793e-09 1.0273923e-09    3.5507401    3.5507365    3.5507365    44.766771 
Loop time of 0.00679111 on 1 procs for 25 steps with 4 atoms

100.0% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543280031     -83.8698683579      -83.869868358
  Force two-norm initial, final = 7.15521 3.95445e-12
  Force max component initial, final = 2.06553 2.48124e-12
  Final line search alpha, max atom move = 1 2.48124e-12
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0057085  | 0.0057085  | 0.0057085  |   0.0 | 84.06
Neigh   | 9.3937e-05 | 9.3937e-05 | 9.3937e-05 |   0.0 |  1.38
Comm    | 0.00061631 | 0.00061631 | 0.00061631 |   0.0 |  9.08
Output  | 0.000211   | 0.000211   | 0.000211   |   0.0 |  3.11
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001614  |            |       |  2.38

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -83.8698683579517
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 1036738.62641854
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036735.45269482
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036740.21328154
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036740.21327924
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.13838952764046e-09
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2.84167926802954e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 1.02739231278055e-09

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -102974885.349205
variable C2pos equal ${d2}
variable C2pos equal -102975361.407895
variable C3pos equal ${d3}
variable C3pos equal -102975361.407649
variable C4pos equal ${d4}
variable C4pos equal 5.16696878228137e-07
variable C5pos equal ${d5}
variable C5pos equal 5.27348413224066e-07
variable C6pos equal ${d6}
variable C6pos equal -7.1411883099165e-08

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(102976141.888587+${C1pos})
variable C11 equal 0.5*(102976141.888587+-102974885.349205)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(102975665.826948+${C2pos})
variable C21 equal 0.5*(102975665.826948+-102975361.407895)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(102975665.826701+${C3pos})
variable C31 equal 0.5*(102975665.826701+-102975361.407649)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-6.55858628491071e-07+${C4pos})
variable C41 equal 0.5*(-6.55858628491071e-07+5.16696878228137e-07)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-1.50554869112388e-06+${C5pos})
variable C51 equal 0.5*(-1.50554869112388e-06+5.27348413224066e-07)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-1.73253490450882e-06+${C6pos})
variable C61 equal 0.5*(-1.73253490450882e-06+-7.1411883099165e-08)

# Delete dir to make sure it is not reused

variable dir delete
# ---- uyy Perturbation
variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 3.5507365122709
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*3.5507365122709
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
change_box all y delta 0 ${delta} remap units box
change_box all y delta 0 -3.5507365122709e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53371 3.53372) with tilt (0 -0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328     6988.451    6988.5386    6988.2759    6988.5386 -2.6234324e-09 2.1743253e-09 6.147694e-09    3.5507365     3.550733    3.5507365    44.766682 
     101            0   -23.226762    107393.53    107393.52    107393.53    107393.52 -6.0248937e-09 3.8931499e-09 1.2762446e-08    3.5507365     3.550733    3.5507365    44.766682 
     102            0   -29.245068    293074.93    293074.73    293075.31    293074.73 -4.5977638e-09 2.6084968e-09 7.8019086e-09    3.5507365     3.550733    3.5507365    44.766682 
     103            0   -36.534906    565091.75    565091.39    565092.46    565091.39 -1.6512056e-09 3.018793e-09 4.972769e-09    3.5507365     3.550733    3.5507365    44.766682 
     104            0   -42.718745    859270.34    859270.13    859270.75    859270.13 1.0090387e-09 -1.6061524e-10 -2.6671276e-09    3.5507365     3.550733    3.5507365    44.766682 
     105            0   -46.073897    1015454.8    1015455.6    1015453.3    1015455.6 2.0635317e-08 -1.763559e-08 -3.9922108e-08    3.5507365     3.550733    3.5507365    44.766682 
     106            0   -50.701117    890870.97    890872.66    890867.58    890872.66 7.2299862e-08 -3.6075631e-08 -1.5676121e-07    3.5507365     3.550733    3.5507365    44.766682 
     107            0   -78.389315    713382.87    713341.25    713466.11    713341.25 -1.1260977e-07 9.6513061e-08 1.9705499e-07    3.5507365     3.550733    3.5507365    44.766682 
     108            0   -83.285885    1166577.5    1166563.8    1166604.9    1166563.8 -1.8072089e-07 1.4034351e-07 3.321819e-07    3.5507365     3.550733    3.5507365    44.766682 
     109            0   -83.861726    1051522.7    1051500.7    1051566.8    1051500.7 -8.2775478e-08  8.04888e-08 1.7127592e-07    3.5507365     3.550733    3.5507365    44.766682 
     110            0   -83.869523    1039520.6    1039501.9    1039558.1    1039501.9 -5.7088975e-08 4.1519844e-08 9.8534203e-08    3.5507365     3.550733    3.5507365    44.766682 
     111            0   -83.869769    1037796.3    1037780.2    1037828.7    1037780.2 -3.5162249e-08 1.9700166e-08 7.2412761e-08    3.5507365     3.550733    3.5507365    44.766682 
     112            0   -83.869808    1037009.9    1036996.4    1037036.9    1036996.4 -2.2483451e-08 1.8988238e-08 3.9154274e-08    3.5507365     3.550733    3.5507365    44.766682 
     113            0   -83.869809    1036952.9    1036940.1    1036978.6    1036940.1 -2.0285927e-08 1.8336285e-08 3.5957282e-08    3.5507365     3.550733    3.5507365    44.766682 
     114            0    -83.86981    1036872.2    1036860.4    1036895.7    1036860.4 -2.5534505e-08 1.5015215e-08 3.4984613e-08    3.5507365     3.550733    3.5507365    44.766682 
     115            0    -83.86981    1036791.3    1036781.1    1036811.6    1036781.1 -1.0706425e-08 9.1301982e-09 1.8063059e-08    3.5507365     3.550733    3.5507365    44.766682 
     116            0    -83.86981    1036725.4    1036718.3    1036739.6    1036718.3 -2.2058037e-09 -5.5168214e-10 1.3267603e-08    3.5507365     3.550733    3.5507365    44.766682 
     117            0    -83.86981    1036724.5    1036717.8    1036737.9    1036717.8 -1.0880341e-09 2.1855857e-09 4.2812992e-09    3.5507365     3.550733    3.5507365    44.766682 
     118            0    -83.86981      1036744    1036738.6    1036754.8    1036738.6 -1.2185397e-09 1.3009295e-09 2.3692531e-09    3.5507365     3.550733    3.5507365    44.766682 
     119            0    -83.86981      1036747    1036745.1      1036751    1036745.1 2.0147418e-09 -5.2760709e-09 -3.5497952e-10    3.5507365     3.550733    3.5507365    44.766682 
     120            0    -83.86981    1036744.7    1036742.9    1036748.2    1036742.9 -1.1875079e-09 3.7064482e-10 2.6528527e-09    3.5507365     3.550733    3.5507365    44.766682 
     121            0    -83.86981    1036744.8    1036743.2      1036748    1036743.2 -5.5320636e-12 -3.5403348e-09 -4.5101433e-09    3.5507365     3.550733    3.5507365    44.766682 
     122            0    -83.86981    1036744.8    1036743.3      1036748    1036743.3 2.1093323e-09 -3.8435785e-10 -1.6701469e-09    3.5507365     3.550733    3.5507365    44.766682 
     123            0    -83.86981    1036744.8    1036743.3      1036748    1036743.3 -2.1176018e-09 -2.7086412e-10 2.0438726e-09    3.5507365     3.550733    3.5507365    44.766682 
     124            0    -83.86981    1036744.8    1036743.3      1036748    1036743.3 -4.1908095e-09 -4.7759674e-10 1.2686441e-09    3.5507365     3.550733    3.5507365    44.766682 
     125            0    -83.86981    1036744.8    1036743.3      1036748    1036743.3 -3.2406878e-09 -1.9733269e-10 2.8777864e-09    3.5507365     3.550733    3.5507365    44.766682 
Loop time of 0.00685287 on 1 procs for 25 steps with 4 atoms

99.1% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543276127     -83.8698104223     -83.8698104223
  Force two-norm initial, final = 7.1552 4.18265e-12
  Force max component initial, final = 2.06553 2.74484e-12
  Final line search alpha, max atom move = 1 2.74484e-12
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0057662  | 0.0057662  | 0.0057662  |   0.0 | 84.14
Neigh   | 9.4891e-05 | 9.4891e-05 | 9.4891e-05 |   0.0 |  1.38
Comm    | 0.00062895 | 0.00062895 | 0.00062895 |   0.0 |  9.18
Output  | 0.00020909 | 0.00020909 | 0.00020909 |   0.0 |  3.05
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001538  |            |       |  2.24

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036743.25747108
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036748.01808961
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036743.25746976
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -3.24068781006541e-09
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1.97332690038678e-10
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 2.87778636368332e-09

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 102975665.826831
variable C2neg equal ${d2}
variable C2neg equal 102976141.888702
variable C3neg equal ${d3}
variable C3neg equal 102975665.826701
variable C4neg equal ${d4}
variable C4neg equal -3.3165747313786e-07
variable C5neg equal ${d5}
variable C5neg equal -2.6291375542498e-07
variable C6neg equal ${d6}
variable C6neg equal -3.881794514333e-08

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*3.5507365122709
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
change_box all y delta 0 ${delta} remap units box
change_box all y delta 0 3.5507365122709e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328    6984.7475      6984.66    6984.9227      6984.66 -2.9118806e-09 1.9647117e-09 7.0174017e-09    3.5507365    3.5507401    3.5507365    44.766771 
     101            0   -23.226764    107389.39    107389.39    107389.38    107389.39 -5.4142539e-09 3.8743724e-09 1.2452194e-08    3.5507365    3.5507401    3.5507365    44.766771 
     102            0   -29.245076    293067.93    293068.13    293067.55    293068.13 -4.6206289e-09 2.933543e-09 9.3473569e-09    3.5507365    3.5507401    3.5507365    44.766771 
     103            0   -36.534927    565084.01    565084.37     565083.3    565084.37 -1.4352548e-09 1.2711872e-09 7.1578984e-09    3.5507365    3.5507401    3.5507365    44.766771 
     104            0   -42.718787    859260.55    859260.75    859260.14    859260.75 1.1198268e-09 -3.4973069e-10 -1.962575e-09    3.5507365    3.5507401    3.5507365    44.766771 
     105            0   -46.073957    1015447.2    1015446.5    1015448.7    1015446.5 1.6096358e-08 -1.4726939e-08 -3.9267476e-08    3.5507365    3.5507401    3.5507365    44.766771 
     106            0   -50.701341    891037.06    891035.37    891040.45    891035.37 2.3248806e-07 -6.5971344e-08 -3.811518e-07    3.5507365    3.5507401    3.5507365    44.766771 
     107            0   -78.390823     713409.9    713451.53    713326.65    713451.53 -2.0416835e-07 1.1774853e-07 4.0300543e-07    3.5507365    3.5507401    3.5507365    44.766771 
     108            0   -83.284937    1166686.8    1166700.5    1166659.3    1166700.5 -3.5244909e-07 1.7303936e-07 6.5572343e-07    3.5507365    3.5507401    3.5507365    44.766771 
     109            0   -83.861814    1051488.9    1051510.9    1051444.8    1051510.9 -1.7172218e-07 7.9295032e-08 3.4866523e-07    3.5507365    3.5507401    3.5507365    44.766771 
     110            0   -83.869577    1039531.3      1039550    1039493.8      1039550 -1.0885807e-07 5.7325432e-08 2.0081732e-07    3.5507365    3.5507401    3.5507365    44.766771 
     111            0   -83.869826    1037804.2    1037820.4    1037771.8    1037820.4 -7.1376779e-08 3.9637934e-08 1.4307471e-07    3.5507365    3.5507401    3.5507365    44.766771 
     112            0   -83.869866    1037011.5      1037025    1036984.5      1037025 -4.9941867e-08 2.5168689e-08 8.8428873e-08    3.5507365    3.5507401    3.5507365    44.766771 
     113            0   -83.869866    1036959.4    1036972.4    1036933.6    1036972.4 -4.0487088e-08 2.4330459e-08 7.6619387e-08    3.5507365    3.5507401    3.5507365    44.766771 
     114            0   -83.869868    1036882.4    1036894.3    1036858.5    1036894.3 -3.622961e-08 2.2628397e-08 6.2613218e-08    3.5507365    3.5507401    3.5507365    44.766771 
     115            0   -83.869868    1036798.4    1036808.8    1036777.5    1036808.8 -2.7684972e-08 1.1760513e-08 4.8297475e-08    3.5507365    3.5507401    3.5507365    44.766771 
     116            0   -83.869868    1036708.1    1036715.2    1036693.9    1036715.2 -6.4563732e-09 1.4736556e-08 6.9871163e-09    3.5507365    3.5507401    3.5507365    44.766771 
     117            0   -83.869868    1036734.1      1036740    1036722.3      1036740 -5.3785824e-11 -1.1002901e-08   4.0586e-09    3.5507365    3.5507401    3.5507365    44.766771 
     118            0   -83.869868      1036743    1036746.8    1036735.5    1036746.8 -3.1226955e-09 -1.1771559e-10 -1.2408128e-09    3.5507365    3.5507401    3.5507365    44.766771 
     119            0   -83.869868    1036738.3    1036739.8    1036735.2    1036739.8 6.4423789e-09 7.8798836e-09 -5.8139272e-09    3.5507365    3.5507401    3.5507365    44.766771 
     120            0   -83.869868    1036738.4    1036739.9    1036735.4    1036739.9 7.427332e-09 9.4524622e-09 9.2456663e-09    3.5507365    3.5507401    3.5507365    44.766771 
     121            0   -83.869868    1036738.7    1036740.2    1036735.6    1036740.2 -2.3342049e-09 2.5893885e-09 -1.0169201e-08    3.5507365    3.5507401    3.5507365    44.766771 
     122            0   -83.869868    1036738.6    1036740.2    1036735.5    1036740.2 -3.083129e-09 4.8450446e-09 1.5157837e-08    3.5507365    3.5507401    3.5507365    44.766771 
     123            0   -83.869868    1036738.6    1036740.2    1036735.5    1036740.2 3.1477323e-09 -4.4296982e-09 3.4891164e-09    3.5507365    3.5507401    3.5507365    44.766771 
     124            0   -83.869868    1036738.6    1036740.2    1036735.5    1036740.2 -4.3428242e-09 3.2151063e-09 1.009926e-09    3.5507365    3.5507401    3.5507365    44.766771 
     125            0   -83.869868    1036738.6    1036740.2    1036735.5    1036740.2 2.4097444e-12 4.657948e-09 -5.467908e-09    3.5507365    3.5507401    3.5507365    44.766771 
Loop time of 0.00690889 on 1 procs for 25 steps with 4 atoms

97.8% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543280031      -83.869868358      -83.869868358
  Force two-norm initial, final = 7.15521 9.83667e-12
  Force max component initial, final = 2.06553 4.62071e-12
  Final line search alpha, max atom move = 1 4.62071e-12
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0058343  | 0.0058343  | 0.0058343  |   0.0 | 84.45
Neigh   | 9.5844e-05 | 9.5844e-05 | 9.5844e-05 |   0.0 |  1.39
Comm    | 0.00061798 | 0.00061798 | 0.00061798 |   0.0 |  8.94
Output  | 0.0002017  | 0.0002017  | 0.0002017  |   0.0 |  2.92
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.000159   |            |       |  2.30

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -83.8698683579587
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 1036738.62641855
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036740.21328058
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036735.45269582
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036740.21327925
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 2.40974435160003e-12
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 4.65794802289334e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -5.46790797003079e-09

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -102975361.407781
variable C2pos equal ${d2}
variable C2pos equal -102974885.349323
variable C3pos equal ${d3}
variable C3pos equal -102975361.40765
variable C4pos equal ${d4}
variable C4pos equal 1.16622690650927e-06
variable C5pos equal ${d5}
variable C5pos equal -2.22614315868222e-07
variable C6pos equal ${d6}
variable C6pos equal -2.85491810298371e-07

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(102975665.826831+${C1pos})
variable C12 equal 0.5*(102975665.826831+-102975361.407781)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(102976141.888702+${C2pos})
variable C22 equal 0.5*(102976141.888702+-102974885.349323)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(102975665.826701+${C3pos})
variable C32 equal 0.5*(102975665.826701+-102975361.40765)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-3.3165747313786e-07+${C4pos})
variable C42 equal 0.5*(-3.3165747313786e-07+1.16622690650927e-06)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-2.6291375542498e-07+${C5pos})
variable C52 equal 0.5*(-2.6291375542498e-07+-2.22614315868222e-07)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-3.881794514333e-08+${C6pos})
variable C62 equal 0.5*(-3.881794514333e-08+-2.85491810298371e-07)

# Delete dir to make sure it is not reused

variable dir delete
# ---- uzz Perturbation
variable dir equal 3
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 3.55073651227262
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*3.55073651227262
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -3.55073651227262e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53371) with tilt (0 -0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328     6988.451    6988.5386    6988.5386    6988.2759 -2.9460639e-09 2.4211081e-09 6.9523254e-09    3.5507365    3.5507365     3.550733    44.766682 
     101            0   -23.226762    107393.53    107393.52    107393.52    107393.53 -6.1851911e-09 3.5435436e-09 1.1556335e-08    3.5507365    3.5507365     3.550733    44.766682 
     102            0   -29.245068    293074.93    293074.73    293074.73    293075.31 -4.6692034e-09 3.1958122e-09 8.6744974e-09    3.5507365    3.5507365     3.550733    44.766682 
     103            0   -36.534906    565091.75    565091.39    565091.39    565092.46 -2.7655619e-09 1.4036247e-09 5.0060827e-09    3.5507365    3.5507365     3.550733    44.766682 
     104            0   -42.718745    859270.34    859270.13    859270.13    859270.75 5.4190235e-10 5.0308372e-10 -1.0754827e-09    3.5507365    3.5507365     3.550733    44.766682 
     105            0   -46.073897    1015454.8    1015455.6    1015455.6    1015453.3 1.6993752e-08 -1.434559e-08 -4.2492263e-08    3.5507365    3.5507365     3.550733    44.766682 
     106            0   -50.701117    890870.97    890872.66    890872.66    890867.58 1.3277495e-07 -4.5889796e-08 -1.4907355e-07    3.5507365    3.5507365     3.550733    44.766682 
     107            0   -78.389315    713382.87    713341.25    713341.25    713466.11 -6.6380384e-08 8.2515141e-08 2.0340401e-07    3.5507365    3.5507365     3.550733    44.766682 
     108            0   -83.285885    1166577.5    1166563.8    1166563.8    1166604.9 -1.4243731e-07 1.3104631e-07 3.5139216e-07    3.5507365    3.5507365     3.550733    44.766682 
     109            0   -83.861726    1051522.7    1051500.7    1051500.7    1051566.8 -7.7437439e-08 5.7392682e-08 1.8236168e-07    3.5507365    3.5507365     3.550733    44.766682 
     110            0   -83.869523    1039520.6    1039501.9    1039501.9    1039558.1 -4.1162705e-08 4.5641708e-08 1.0166495e-07    3.5507365    3.5507365     3.550733    44.766682 
     111            0   -83.869769    1037796.3    1037780.2    1037780.2    1037828.7 -3.0721431e-08 2.8431005e-08 7.0877375e-08    3.5507365    3.5507365     3.550733    44.766682 
     112            0   -83.869808    1037009.9    1036996.4    1036996.4    1037036.9 -1.0678286e-08 1.2262261e-08 4.7387178e-08    3.5507365    3.5507365     3.550733    44.766682 
     113            0   -83.869809    1036952.9    1036940.1    1036940.1    1036978.6 -1.6039918e-08 1.486356e-08 4.3904459e-08    3.5507365    3.5507365     3.550733    44.766682 
     114            0    -83.86981    1036872.2    1036860.4    1036860.4    1036895.7 -6.4139388e-09 9.8534881e-09 3.1393832e-08    3.5507365    3.5507365     3.550733    44.766682 
     115            0    -83.86981    1036791.3    1036781.1    1036781.1    1036811.6 -3.3353213e-09 3.7073553e-09 2.4792388e-08    3.5507365    3.5507365     3.550733    44.766682 
     116            0    -83.86981    1036725.4    1036718.3    1036718.3    1036739.6 -6.4148251e-09 7.6130979e-09 9.9626306e-09    3.5507365    3.5507365     3.550733    44.766682 
     117            0    -83.86981    1036724.5    1036717.8    1036717.8    1036737.9 -1.9982302e-09 9.1613451e-09 5.1964545e-09    3.5507365    3.5507365     3.550733    44.766682 
     118            0    -83.86981      1036744    1036738.6    1036738.6    1036754.8 -3.1407169e-09 5.2542617e-10 4.4692175e-09    3.5507365    3.5507365     3.550733    44.766682 
     119            0    -83.86981      1036747    1036745.1    1036745.1      1036751 1.0816757e-08 2.8344029e-10 1.5854959e-11    3.5507365    3.5507365     3.550733    44.766682 
     120            0    -83.86981    1036744.7    1036742.9    1036742.9    1036748.2 -3.16601e-09 7.6221852e-10 -1.0206601e-08    3.5507365    3.5507365     3.550733    44.766682 
     121            0    -83.86981    1036744.8    1036743.2    1036743.2      1036748 7.530668e-09 4.7626481e-10 1.2190605e-08    3.5507365    3.5507365     3.550733    44.766682 
     122            0    -83.86981    1036744.8    1036743.3    1036743.3      1036748 -4.2739678e-09 2.4962742e-10 9.6597937e-09    3.5507365    3.5507365     3.550733    44.766682 
     123            0    -83.86981    1036744.8    1036743.3    1036743.3      1036748 1.0722665e-08 2.6640615e-10 -2.2284623e-08    3.5507365    3.5507365     3.550733    44.766682 
     124            0    -83.86981    1036744.8    1036743.3    1036743.3      1036748 7.3908309e-09 9.0970474e-10 -4.5684302e-09    3.5507365    3.5507365     3.550733    44.766682 
     125            0    -83.86981    1036744.8    1036743.3    1036743.3      1036748 -1.1779176e-08 7.8883064e-10 6.0207674e-09    3.5507365    3.5507365     3.550733    44.766682 
Loop time of 0.007725 on 1 procs for 25 steps with 4 atoms

88.5% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543276127     -83.8698104223     -83.8698104223
  Force two-norm initial, final = 7.1552 8.99409e-12
  Force max component initial, final = 2.06553 3.87977e-12
  Final line search alpha, max atom move = 1 3.87977e-12
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0066326  | 0.0066326  | 0.0066326  |   0.0 | 85.86
Neigh   | 9.3937e-05 | 9.3937e-05 | 9.3937e-05 |   0.0 |  1.22
Comm    | 0.00062394 | 0.00062394 | 0.00062394 |   0.0 |  8.08
Output  | 0.00021935 | 0.00021935 | 0.00021935 |   0.0 |  2.84
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001552  |            |       |  2.01

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036743.25747107
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036743.25747206
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036748.0180873
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.17791759580996e-08
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 7.88830644795821e-10
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 6.02076736954536e-09

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 102975665.82683
variable C2neg equal ${d2}
variable C2neg equal 102975665.826947
variable C3neg equal ${d3}
variable C3neg equal 102976141.888455
variable C4neg equal ${d4}
variable C4neg equal -1.73593725516561e-08
variable C5neg equal ${d5}
variable C5neg equal -1.6429742194153e-07
variable C6neg equal ${d6}
variable C6neg equal -8.92666759946749e-07

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*3.55073651227262
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 3.55073651227262e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328    6984.7475      6984.66    6984.6599    6984.9227 -3.2046721e-09 2.448402e-09 6.9519785e-09    3.5507365    3.5507365    3.5507401    44.766771 
     101            0   -23.226764    107389.39    107389.39    107389.39    107389.38 -6.0131427e-09 3.6544896e-09 1.2042345e-08    3.5507365    3.5507365    3.5507401    44.766771 
     102            0   -29.245076    293067.93    293068.13    293068.13    293067.55 -4.6779357e-09 3.9600084e-09 1.0336503e-08    3.5507365    3.5507365    3.5507401    44.766771 
     103            0   -36.534927    565084.01    565084.37    565084.37     565083.3 -3.197664e-09 2.4304769e-09 6.5875786e-09    3.5507365    3.5507365    3.5507401    44.766771 
     104            0   -42.718787    859260.55    859260.75    859260.75    859260.14 9.3420341e-10 8.4561442e-11 -1.6205342e-09    3.5507365    3.5507365    3.5507401    44.766771 
     105            0   -46.073957    1015447.2    1015446.5    1015446.5    1015448.7 1.6243312e-08 -1.572355e-08 -4.0627224e-08    3.5507365    3.5507365    3.5507401    44.766771 
     106            0   -50.701341    891037.06    891035.37    891035.37    891040.45 2.2275638e-07 -8.6273957e-08 -3.5150603e-07    3.5507365    3.5507365    3.5507401    44.766771 
     107            0   -78.390823     713409.9    713451.53    713451.53    713326.65 -1.8754973e-07 1.3433868e-07 4.0341445e-07    3.5507365    3.5507365    3.5507401    44.766771 
     108            0   -83.284937    1166686.8    1166700.5    1166700.5    1166659.3 -3.2510689e-07 2.0235628e-07 6.4464224e-07    3.5507365    3.5507365    3.5507401    44.766771 
     109            0   -83.861814    1051488.9    1051510.9    1051510.9    1051444.8 -1.670283e-07 1.0183214e-07 3.3497451e-07    3.5507365    3.5507365    3.5507401    44.766771 
     110            0   -83.869577    1039531.3      1039550      1039550    1039493.8 -1.0142695e-07 6.2159839e-08 1.9065111e-07    3.5507365    3.5507365    3.5507401    44.766771 
     111            0   -83.869826    1037804.2    1037820.4    1037820.4    1037771.8 -7.3299796e-08 4.7266986e-08 1.3492612e-07    3.5507365    3.5507365    3.5507401    44.766771 
     112            0   -83.869866    1037011.5      1037025      1037025    1036984.5 -3.9550198e-08 2.3767847e-08 9.1115376e-08    3.5507365    3.5507365    3.5507401    44.766771 
     113            0   -83.869866    1036959.4    1036972.4    1036972.4    1036933.6 -5.1206487e-08 1.7570006e-08 8.5213809e-08    3.5507365    3.5507365    3.5507401    44.766771 
     114            0   -83.869868    1036882.4    1036894.3    1036894.3    1036858.5 -3.1973396e-08 1.8789049e-08 6.0247608e-08    3.5507365    3.5507365    3.5507401    44.766771 
     115            0   -83.869868    1036798.4    1036808.8    1036808.8    1036777.5 -3.5069928e-08 1.4292566e-08 3.5520991e-08    3.5507365    3.5507365    3.5507401    44.766771 
     116            0   -83.869868    1036708.1    1036715.2    1036715.2    1036693.9 1.175348e-09 8.8533518e-09 2.3123269e-08    3.5507365    3.5507365    3.5507401    44.766771 
     117            0   -83.869868    1036734.1      1036740      1036740    1036722.3 6.3660059e-09 9.2193528e-09 1.0333782e-08    3.5507365    3.5507365    3.5507401    44.766771 
     118            0   -83.869868      1036743    1036746.8    1036746.8    1036735.5 -6.3829807e-09 -7.2417346e-09 3.6620217e-09    3.5507365    3.5507365    3.5507401    44.766771 
     119            0   -83.869868    1036738.3    1036739.8    1036739.8    1036735.2 -6.2097744e-09 -2.9534941e-09 -4.3056214e-09    3.5507365    3.5507365    3.5507401    44.766771 
     120            0   -83.869868    1036738.4    1036739.9    1036739.9    1036735.4 -3.2599157e-09 -2.802197e-09 -8.9915173e-10    3.5507365    3.5507365    3.5507401    44.766771 
     121            0   -83.869868    1036738.7    1036740.2    1036740.2    1036735.6 5.8264732e-11 6.9299997e-09 -2.9426157e-09    3.5507365    3.5507365    3.5507401    44.766771 
     122            0   -83.869868    1036738.6    1036740.2    1036740.2    1036735.5 -4.119531e-11 5.856259e-10 9.9248701e-09    3.5507365    3.5507365    3.5507401    44.766771 
     123            0   -83.869868    1036738.6    1036740.2    1036740.2    1036735.5 -6.2641959e-09 -4.2730496e-09 -3.2886405e-09    3.5507365    3.5507365    3.5507401    44.766771 
     124            0   -83.869868    1036738.6    1036740.2    1036740.2    1036735.5 6.4249181e-09 -3.4218845e-11 7.0650155e-09    3.5507365    3.5507365    3.5507401    44.766771 
     125            0   -83.869868    1036738.6    1036740.2    1036740.2    1036735.5 8.3720873e-09 8.8954489e-10 -6.457177e-09    3.5507365    3.5507365    3.5507401    44.766771 
Loop time of 0.00716901 on 1 procs for 25 steps with 4 atoms

94.8% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543280031     -83.8698683579      -83.869868358
  Force two-norm initial, final = 7.15521 7.78282e-12
  Force max component initial, final = 2.06553 4.02123e-12
  Final line search alpha, max atom move = 1 4.02123e-12
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0056701  | 0.0056701  | 0.0056701  |   0.0 | 79.09
Neigh   | 9.4891e-05 | 9.4891e-05 | 9.4891e-05 |   0.0 |  1.32
Comm    | 0.00061917 | 0.00061917 | 0.00061917 |   0.0 |  8.64
Output  | 0.00061846 | 0.00061846 | 0.00061846 |   0.0 |  8.63
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001664  |            |       |  2.32

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -83.8698683579589
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 1036738.62641853
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036740.21328056
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036740.21328155
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036735.45269347
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 8.37208729156271e-09
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 8.89544893803139e-10
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -6.45717700061375e-09

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -102975361.407779
variable C2pos equal ${d2}
variable C2pos equal -102975361.407896
variable C3pos equal ${d3}
variable C3pos equal -102974885.349072
variable C4pos equal ${d4}
variable C4pos equal 1.26515380956757e-06
variable C5pos equal ${d5}
variable C5pos equal 1.54225997040798e-07
variable C6pos equal ${d6}
variable C6pos equal -1.12245956501948e-06

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(102975665.82683+${C1pos})
variable C13 equal 0.5*(102975665.82683+-102975361.407779)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(102975665.826947+${C2pos})
variable C23 equal 0.5*(102975665.826947+-102975361.407896)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(102976141.888455+${C3pos})
variable C33 equal 0.5*(102976141.888455+-102974885.349072)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-1.73593725516561e-08+${C4pos})
variable C43 equal 0.5*(-1.73593725516561e-08+1.26515380956757e-06)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-1.6429742194153e-07+${C5pos})
variable C53 equal 0.5*(-1.6429742194153e-07+1.54225997040798e-07)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-8.92666759946749e-07+${C6pos})
variable C63 equal 0.5*(-8.92666759946749e-07+-1.12245956501948e-06)

# Delete dir to make sure it is not reused

variable dir delete
# ---- uyz Perturbation
variable dir equal 4
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 3.55073651227262
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*3.55073651227262
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -3.55073651227262e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 -3.55074e-06)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328    6986.5992    6986.5992    6986.5992    6986.5992 -2.8634608e-09 1.5291406e-09  -0.61906222    3.5507365    3.5507365    3.5507365    44.766726 
     101            0   -23.226752    107391.19    107391.19    107391.19    107391.19 -5.7609344e-09 4.0285121e-09  -0.71197185    3.5507365    3.5507365    3.5507365    44.766726 
     102            0    -29.24504    293069.36    293069.36    293069.36    293069.36 -5.0864516e-09 2.2273738e-09  -0.58594935    3.5507365    3.5507365    3.5507365    44.766726 
     103            0   -36.534868     565084.3     565084.3     565084.3     565084.3 9.9215647e-10 4.3910304e-09  -0.51261657    3.5507365    3.5507365    3.5507365    44.766726 
     104            0   -42.718724    859256.55    859256.55    859256.55    859256.55 3.7087443e-10 -1.3393827e-09  -0.25142293    3.5507365    3.5507365    3.5507365    44.766726 
     105            0   -46.073904      1015433      1015433      1015433      1015433 1.1010852e-08 -2.8188531e-09   0.96196193    3.5507365    3.5507365    3.5507365    44.766726 
     106            0   -50.701339     891081.3     891081.3     891081.3     891081.3 3.272215e-07 -2.9595356e-07    23.774032    3.5507365    3.5507365    3.5507365    44.766726 
     107            0   -78.390195    713399.22    713399.22    713399.22    713399.22 -2.2142635e-07 1.662355e-07   -22.267035    3.5507365    3.5507365    3.5507365    44.766726 
     108            0   -83.285413      1166632      1166632      1166632      1166632 -3.9575071e-07 2.8238018e-07   -36.665445    3.5507365    3.5507365    3.5507365    44.766726 
     109            0   -83.861773    1051503.3    1051503.3    1051503.3    1051503.3 -2.1178721e-07 1.5514112e-07   -19.386935    3.5507365    3.5507365    3.5507365    44.766726 
     110            0   -83.869548    1039534.6    1039534.6    1039534.6    1039534.6 -1.0892369e-07 8.5273749e-08   -11.665301    3.5507365    3.5507365    3.5507365    44.766726 
     111            0   -83.869796    1037813.6    1037813.6    1037813.6    1037813.6 -8.3968499e-08 6.047244e-08   -8.2350558    3.5507365    3.5507365    3.5507365    44.766726 
     112            0   -83.869837      1037019      1037019      1037019      1037019 -5.3395466e-08 3.4699013e-08   -5.3849548    3.5507365    3.5507365    3.5507365    44.766726 
     113            0   -83.869837    1036970.7    1036970.7    1036970.7    1036970.7 -4.9088027e-08 3.7986857e-08   -4.9637318    3.5507365    3.5507365    3.5507365    44.766726 
     114            0   -83.869838    1036897.5    1036897.5    1036897.5    1036897.5 -3.9464189e-08 3.0246521e-08   -4.2579119    3.5507365    3.5507365    3.5507365    44.766726 
     115            0   -83.869839    1036813.4    1036813.4    1036813.4    1036813.4 -2.9918035e-08 1.7410185e-08   -3.2572086    3.5507365    3.5507365    3.5507365    44.766726 
     116            0   -83.869839    1036701.2    1036701.2    1036701.2    1036701.2 -5.422131e-09 3.7771378e-09   -1.1387581    3.5507365    3.5507365    3.5507365    44.766726 
     117            0   -83.869839    1036731.6    1036731.6    1036731.6    1036731.6 -2.1666704e-09 5.814423e-09  -0.91879495    3.5507365    3.5507365    3.5507365    44.766726 
     118            0   -83.869839    1036741.1    1036741.1    1036741.1    1036741.1 -1.0701895e-08 5.8733956e-09  -0.74744951    3.5507365    3.5507365    3.5507365    44.766726 
     119            0   -83.869839    1036741.7    1036741.8    1036741.7    1036741.7 -1.0585273e-08 2.7959111e-09  -0.64741808    3.5507365    3.5507365    3.5507365    44.766726 
     120            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7  1.17684e-08 -1.3166873e-09   -0.5520632    3.5507365    3.5507365    3.5507365    44.766726 
     121            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 9.5474407e-09 -3.4551995e-09  -0.55157771    3.5507365    3.5507365    3.5507365    44.766726 
     122            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -1.495779e-08 1.4385828e-08  -0.55160347    3.5507365    3.5507365    3.5507365    44.766726 
     123            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -8.6328416e-09 -1.0341021e-08  -0.55159409    3.5507365    3.5507365    3.5507365    44.766726 
     124            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 1.1574601e-08 -3.7938337e-09  -0.55159267    3.5507365    3.5507365    3.5507365    44.766726 
     125            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -1.6543778e-10 1.811921e-09  -0.55159154    3.5507365    3.5507365    3.5507365    44.766726 
Loop time of 0.00883198 on 1 procs for 25 steps with 4 atoms

77.0% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543278079     -83.8698393902     -83.8698393902
  Force two-norm initial, final = 7.1552 7.37932e-11
  Force max component initial, final = 2.06553 2.80278e-11
  Final line search alpha, max atom move = 1 2.80278e-11
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0077245  | 0.0077245  | 0.0077245  |   0.0 | 87.46
Neigh   | 9.6083e-05 | 9.6083e-05 | 9.6083e-05 |   0.0 |  1.09
Comm    | 0.00062466 | 0.00062466 | 0.00062466 |   0.0 |  7.07
Output  | 0.00023246 | 0.00023246 | 0.00023246 |   0.0 |  2.63
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001543  |            |       |  1.75

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036741.73537325
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036741.73537526
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036741.73536946
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.65437784595609e-10
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1.81192100314807e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -0.551591538318384

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 102975513.617048
variable C2neg equal ${d2}
variable C2neg equal 102975513.617267
variable C3neg equal ${d3}
variable C3neg equal 102975513.616671
variable C4neg equal ${d4}
variable C4neg equal -55.1591544512745
variable C5neg equal ${d5}
variable C5neg equal -6.1988386106305e-08
variable C6neg equal ${d6}
variable C6neg equal 2.6870705740365e-07

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*3.55073651227262
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 3.55073651227262e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 3.55074e-06)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328    6986.5992    6986.5992    6986.5992    6986.5992 -3.1140772e-09 1.7135715e-09   0.61906223    3.5507365    3.5507365    3.5507365    44.766726 
     101            0   -23.226752    107391.19    107391.19    107391.19    107391.19 -6.0819726e-09 4.2490401e-09   0.71197187    3.5507365    3.5507365    3.5507365    44.766726 
     102            0    -29.24504    293069.36    293069.36    293069.36    293069.36 -5.2680718e-09 3.6337593e-09   0.58594936    3.5507365    3.5507365    3.5507365    44.766726 
     103            0   -36.534868     565084.3     565084.3     565084.3     565084.3 -2.042666e-09 2.1487638e-09   0.51261658    3.5507365    3.5507365    3.5507365    44.766726 
     104            0   -42.718724    859256.55    859256.55    859256.55    859256.55 1.0315789e-09 -2.5520013e-10   0.25142292    3.5507365    3.5507365    3.5507365    44.766726 
     105            0   -46.073904      1015433      1015433      1015433      1015433 1.491606e-08 -1.183734e-08  -0.96196197    3.5507365    3.5507365    3.5507365    44.766726 
     106            0   -50.701339     891081.3     891081.3     891081.3     891081.3 3.0069178e-07 -1.8657593e-07   -23.774033    3.5507365    3.5507365    3.5507365    44.766726 
     107            0   -78.390195    713399.22    713399.22    713399.22    713399.22 -2.6183218e-07 1.9520956e-07    22.267036    3.5507365    3.5507365    3.5507365    44.766726 
     108            0   -83.285413      1166632      1166632      1166632      1166632 -4.366224e-07 3.0807448e-07    36.665446    3.5507365    3.5507365    3.5507365    44.766726 
     109            0   -83.861773    1051503.3    1051503.3    1051503.3    1051503.3 -2.272008e-07 1.633328e-07    19.386936    3.5507365    3.5507365    3.5507365    44.766726 
     110            0   -83.869548    1039534.6    1039534.6    1039534.6    1039534.6 -1.3534034e-07 9.9838998e-08    11.665302    3.5507365    3.5507365    3.5507365    44.766726 
     111            0   -83.869796    1037813.6    1037813.6    1037813.6    1037813.6 -9.2376972e-08 6.7292497e-08    8.2350561    3.5507365    3.5507365    3.5507365    44.766726 
     112            0   -83.869837      1037019      1037019      1037019      1037019 -6.283589e-08 4.2100764e-08     5.384955    3.5507365    3.5507365    3.5507365    44.766726 
     113            0   -83.869837    1036970.7    1036970.7    1036970.7    1036970.7 -5.7463906e-08 3.1585396e-08     4.963732    3.5507365    3.5507365    3.5507365    44.766726 
     114            0   -83.869838    1036897.5    1036897.5    1036897.5    1036897.5 -4.0361286e-08 2.7091418e-08    4.2579121    3.5507365    3.5507365    3.5507365    44.766726 
     115            0   -83.869839    1036813.4    1036813.4    1036813.4    1036813.4 -3.5146963e-08 1.9607201e-08    3.2572087    3.5507365    3.5507365    3.5507365    44.766726 
     116            0   -83.869839    1036701.2    1036701.2    1036701.2    1036701.2 -6.3694902e-09 4.5743195e-09    1.1387581    3.5507365    3.5507365    3.5507365    44.766726 
     117            0   -83.869839    1036731.6    1036731.6    1036731.6    1036731.6 -1.0649796e-09 2.9963557e-09   0.91879497    3.5507365    3.5507365    3.5507365    44.766726 
     118            0   -83.869839    1036741.1    1036741.1    1036741.1    1036741.1 -2.0557005e-09 8.1456248e-09   0.74744951    3.5507365    3.5507365    3.5507365    44.766726 
     119            0   -83.869839    1036741.7    1036741.8    1036741.7    1036741.7 -2.0425824e-09 1.1673983e-09   0.64741808    3.5507365    3.5507365    3.5507365    44.766726 
     120            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 7.4752203e-09 1.0769794e-09    0.5520632    3.5507365    3.5507365    3.5507365    44.766726 
     121            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 6.3034236e-09 3.9821975e-10   0.55157773    3.5507365    3.5507365    3.5507365    44.766726 
     122            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -1.3812175e-08 -3.1166954e-11   0.55160346    3.5507365    3.5507365    3.5507365    44.766726 
     123            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 6.0214975e-11 2.1919602e-10   0.55159409    3.5507365    3.5507365    3.5507365    44.766726 
     124            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -1.112826e-09 2.3877342e-10   0.55159268    3.5507365    3.5507365    3.5507365    44.766726 
     125            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -2.6185236e-11 4.5517176e-10   0.55159154    3.5507365    3.5507365    3.5507365    44.766726 
Loop time of 0.0071249 on 1 procs for 25 steps with 4 atoms

95.3% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543278079     -83.8698393902     -83.8698393902
  Force two-norm initial, final = 7.1552 7.38222e-11
  Force max component initial, final = 2.06553 2.96372e-11
  Final line search alpha, max atom move = 1 2.96372e-11
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0060463  | 0.0060463  | 0.0060463  |   0.0 | 84.86
Neigh   | 9.5844e-05 | 9.5844e-05 | 9.5844e-05 |   0.0 |  1.35
Comm    | 0.00061941 | 0.00061941 | 0.00061941 |   0.0 |  8.69
Output  | 0.00021338 | 0.00021338 | 0.00021338 |   0.0 |  2.99
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.00015    |            |       |  2.10

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -83.8698393902304
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 1036741.73537267
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036741.73537326
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036741.73537528
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036741.73536947
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.61852356909706e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 4.55171763125376e-10
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 0.551591535066933

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -102975513.617049
variable C2pos equal ${d2}
variable C2pos equal -102975513.617269
variable C3pos equal ${d3}
variable C3pos equal -102975513.616672
variable C4pos equal ${d4}
variable C4pos equal -55.1591528872572
variable C5pos equal ${d5}
variable C5pos equal 1.97663310108574e-07
variable C6pos equal ${d6}
variable C6pos equal -2.82632312294114e-07

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(102975513.617048+${C1pos})
variable C14 equal 0.5*(102975513.617048+-102975513.617049)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(102975513.617267+${C2pos})
variable C24 equal 0.5*(102975513.617267+-102975513.617269)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(102975513.616671+${C3pos})
variable C34 equal 0.5*(102975513.616671+-102975513.616672)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-55.1591544512745+${C4pos})
variable C44 equal 0.5*(-55.1591544512745+-55.1591528872572)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-6.1988386106305e-08+${C5pos})
variable C54 equal 0.5*(-6.1988386106305e-08+1.97663310108574e-07)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(2.6870705740365e-07+${C6pos})
variable C64 equal 0.5*(2.6870705740365e-07+-2.82632312294114e-07)

# Delete dir to make sure it is not reused

variable dir delete
# ---- uxz Perturbation
variable dir equal 5
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 3.55073651227262
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*3.55073651227262
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -3.55073651227262e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -3.55074e-06 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328    6986.5992    6986.5992    6986.5992    6986.5992 -2.7155012e-09  -0.61906222 6.3259795e-09    3.5507365    3.5507365    3.5507365    44.766726 
     101            0   -23.226752    107391.19    107391.19    107391.19    107391.19 -5.2793024e-09  -0.71197186 1.1916793e-08    3.5507365    3.5507365    3.5507365    44.766726 
     102            0    -29.24504    293069.36    293069.36    293069.36    293069.36 -2.6125964e-09  -0.58594935 7.9691852e-09    3.5507365    3.5507365    3.5507365    44.766726 
     103            0   -36.534868     565084.3     565084.3     565084.3     565084.3 -2.9543536e-09  -0.51261658 6.5639202e-09    3.5507365    3.5507365    3.5507365    44.766726 
     104            0   -42.718724    859256.55    859256.55    859256.55    859256.55 9.1828286e-10  -0.25142293 -3.5834578e-09    3.5507365    3.5507365    3.5507365    44.766726 
     105            0   -46.073904      1015433      1015433      1015433      1015433 1.2443043e-08   0.96196193 -2.940892e-08    3.5507365    3.5507365    3.5507365    44.766726 
     106            0   -50.701339     891081.3     891081.3     891081.3     891081.3 2.5006523e-07    23.774016 -5.4336538e-07    3.5507365    3.5507365    3.5507365    44.766726 
     107            0   -78.390195    713399.22    713399.22    713399.22    713399.22 -1.711368e-07   -22.267013 4.4574681e-07    3.5507365    3.5507365    3.5507365    44.766726 
     108            0   -83.285413      1166632      1166632      1166632      1166632 -2.9504444e-07   -36.665413 7.4312242e-07    3.5507365    3.5507365    3.5507365    44.766726 
     109            0   -83.861773    1051503.3    1051503.3    1051503.3    1051503.3 -1.5076212e-07   -19.386919 3.9665402e-07    3.5507365    3.5507365    3.5507365    44.766726 
     110            0   -83.869548    1039534.6    1039534.6    1039534.6    1039534.6 -9.62452e-08   -11.665291 2.2825003e-07    3.5507365    3.5507365    3.5507365    44.766726 
     111            0   -83.869796    1037813.6    1037813.6    1037813.6    1037813.6 -6.5845103e-08    -8.235049 1.621226e-07    3.5507365    3.5507365    3.5507365    44.766726 
     112            0   -83.869837      1037019      1037019      1037019      1037019 -3.5219842e-08   -5.3849505 9.9972565e-08    3.5507365    3.5507365    3.5507365    44.766726 
     113            0   -83.869837    1036970.7    1036970.7    1036970.7    1036970.7 -3.6195226e-08   -4.9637278 8.7687227e-08    3.5507365    3.5507365    3.5507365    44.766726 
     114            0   -83.869838    1036897.5    1036897.5    1036897.5    1036897.5 -2.8644177e-08   -4.2579085 7.4910081e-08    3.5507365    3.5507365    3.5507365    44.766726 
     115            0   -83.869839    1036813.4    1036813.4    1036813.4    1036813.4 -2.3466674e-08   -3.2572059 5.9955829e-08    3.5507365    3.5507365    3.5507365    44.766726 
     116            0   -83.869839    1036701.2    1036701.2    1036701.2    1036701.2 -1.3686706e-10   -1.1387578 1.2779483e-08    3.5507365    3.5507365    3.5507365    44.766726 
     117            0   -83.869839    1036731.6    1036731.6    1036731.6    1036731.6 -3.0561307e-09  -0.91879471 7.8397454e-09    3.5507365    3.5507365    3.5507365    44.766726 
     118            0   -83.869839    1036741.1    1036741.1    1036741.1    1036741.1 -1.3834898e-08  -0.74744936 8.3807618e-09    3.5507365    3.5507365    3.5507365    44.766726 
     119            0   -83.869839    1036741.7    1036741.7    1036741.8    1036741.7 3.2687045e-09    -0.647418  7.58513e-09    3.5507365    3.5507365    3.5507365    44.766726 
     120            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -3.1535841e-09  -0.55206319 -1.0825807e-08    3.5507365    3.5507365    3.5507365    44.766726 
     121            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -1.0021827e-09  -0.55157773 -4.3662457e-11    3.5507365    3.5507365    3.5507365    44.766726 
     122            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 7.462591e-09  -0.55160335 -1.372671e-09    3.5507365    3.5507365    3.5507365    44.766726 
     123            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 8.4767114e-09  -0.55159416 -2.9860185e-09    3.5507365    3.5507365    3.5507365    44.766726 
     124            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 2.1264974e-09  -0.55159269 1.0584362e-08    3.5507365    3.5507365    3.5507365    44.766726 
     125            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -1.0573007e-08  -0.55159155 -1.0631969e-08    3.5507365    3.5507365    3.5507365    44.766726 
Loop time of 0.00666499 on 1 procs for 25 steps with 4 atoms

100.0% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543278079     -83.8698393902     -83.8698393902
  Force two-norm initial, final = 7.1552 7.58476e-11
  Force max component initial, final = 2.06553 3.0811e-11
  Final line search alpha, max atom move = 1 3.0811e-11
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0055792  | 0.0055792  | 0.0055792  |   0.0 | 83.71
Neigh   | 9.6083e-05 | 9.6083e-05 | 9.6083e-05 |   0.0 |  1.44
Comm    | 0.00061893 | 0.00061893 | 0.00061893 |   0.0 |  9.29
Output  | 0.00021791 | 0.00021791 | 0.00021791 |   0.0 |  3.27
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001528  |            |       |  2.29

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036741.73537426
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036741.73537423
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036741.73536945
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.05730068490766e-08
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -0.551591553585575
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1.06319693981628e-08

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 102975513.617149
variable C2neg equal ${d2}
variable C2neg equal 102975513.617164
variable C3neg equal ${d3}
variable C3neg equal 102975513.61667
variable C4neg equal ${d4}
variable C4neg equal -1.68263304932247e-06
variable C5neg equal ${d5}
variable C5neg equal -55.159155601738
variable C6neg equal ${d6}
variable C6neg equal -7.72049849044449e-07

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*3.55073651227262
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 3.55073651227262e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 3.55074e-06 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328    6986.5992    6986.5992    6986.5992    6986.5992 -3.5276052e-09   0.61906223 6.7448921e-09    3.5507365    3.5507365    3.5507365    44.766726 
     101            0   -23.226752    107391.19    107391.19    107391.19    107391.19 -5.8771117e-09   0.71197187 1.1972472e-08    3.5507365    3.5507365    3.5507365    44.766726 
     102            0    -29.24504    293069.36    293069.36    293069.36    293069.36 -3.6342025e-09   0.58594936 8.8918345e-09    3.5507365    3.5507365    3.5507365    44.766726 
     103            0   -36.534868     565084.3     565084.3     565084.3     565084.3 -3.1545331e-09   0.51261658 4.8173658e-09    3.5507365    3.5507365    3.5507365    44.766726 
     104            0   -42.718724    859256.55    859256.55    859256.55    859256.55 3.6592286e-10   0.25142292 -2.3853138e-09    3.5507365    3.5507365    3.5507365    44.766726 
     105            0   -46.073904      1015433      1015433      1015433      1015433 2.3158702e-08  -0.96196195 -3.5672647e-08    3.5507365    3.5507365    3.5507365    44.766726 
     106            0   -50.701339     891081.3     891081.3     891081.3     891081.3 1.5977991e-07   -23.774017 -4.2978254e-07    3.5507365    3.5507365    3.5507365    44.766726 
     107            0   -78.390195    713399.22    713399.22    713399.22    713399.22 -2.5113058e-07    22.267013 4.4472327e-07    3.5507365    3.5507365    3.5507365    44.766726 
     108            0   -83.285413      1166632      1166632      1166632      1166632 -3.9099878e-07    36.665413 7.2038264e-07    3.5507365    3.5507365    3.5507365    44.766726 
     109            0   -83.861773    1051503.3    1051503.3    1051503.3    1051503.3 -2.047907e-07    19.386919 3.7305988e-07    3.5507365    3.5507365    3.5507365    44.766726 
     110            0   -83.869548    1039534.6    1039534.6    1039534.6    1039534.6 -1.2900368e-07    11.665291 2.2548663e-07    3.5507365    3.5507365    3.5507365    44.766726 
     111            0   -83.869796    1037813.6    1037813.6    1037813.6    1037813.6 -8.6195005e-08     8.235049 1.5624999e-07    3.5507365    3.5507365    3.5507365    44.766726 
     112            0   -83.869837      1037019      1037019      1037019      1037019 -5.5391821e-08    5.3849505 1.0382842e-07    3.5507365    3.5507365    3.5507365    44.766726 
     113            0   -83.869837    1036970.7    1036970.7    1036970.7    1036970.7 -5.4296945e-08    4.9637278 8.9652156e-08    3.5507365    3.5507365    3.5507365    44.766726 
     114            0   -83.869838    1036897.5    1036897.5    1036897.5    1036897.5 -3.8391778e-08    4.2579085 7.4256461e-08    3.5507365    3.5507365    3.5507365    44.766726 
     115            0   -83.869839    1036813.4    1036813.4    1036813.4    1036813.4 -1.8176709e-08     3.257206 5.0553544e-08    3.5507365    3.5507365    3.5507365    44.766726 
     116            0   -83.869839    1036701.2    1036701.2    1036701.2    1036701.2 -7.5481789e-09    1.1387578 2.0179826e-08    3.5507365    3.5507365    3.5507365    44.766726 
     117            0   -83.869839    1036731.6    1036731.6    1036731.6    1036731.6 -1.0688346e-09   0.91879471 1.0350132e-08    3.5507365    3.5507365    3.5507365    44.766726 
     118            0   -83.869839    1036741.1    1036741.1    1036741.1    1036741.1 -3.3401985e-09   0.74744936 1.2841842e-09    3.5507365    3.5507365    3.5507365    44.766726 
     119            0   -83.869839    1036741.7    1036741.7    1036741.8    1036741.7 -1.3752149e-08   0.64741799 4.1259679e-09    3.5507365    3.5507365    3.5507365    44.766726 
     120            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 5.2688031e-09    0.5520632 -3.3227724e-09    3.5507365    3.5507365    3.5507365    44.766726 
     121            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 1.0737134e-08   0.55157773 -1.9330065e-09    3.5507365    3.5507365    3.5507365    44.766726 
     122            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -8.5264448e-09   0.55160334 8.3885908e-09    3.5507365    3.5507365    3.5507365    44.766726 
     123            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -9.6102846e-09   0.55159416 -3.2043741e-09    3.5507365    3.5507365    3.5507365    44.766726 
     124            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 3.0988573e-09   0.55159271 1.0390517e-08    3.5507365    3.5507365    3.5507365    44.766726 
     125            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7 -1.1909906e-09   0.55159153 -1.7875883e-08    3.5507365    3.5507365    3.5507365    44.766726 
Loop time of 0.00670409 on 1 procs for 25 steps with 4 atoms

100.0% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543278079     -83.8698393902     -83.8698393902
  Force two-norm initial, final = 7.1552 7.94661e-11
  Force max component initial, final = 2.06553 3.09888e-11
  Final line search alpha, max atom move = 1 3.09888e-11
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0056269  | 0.0056269  | 0.0056269  |   0.0 | 83.93
Neigh   | 9.6083e-05 | 9.6083e-05 | 9.6083e-05 |   0.0 |  1.43
Comm    | 0.0006237  | 0.0006237  | 0.0006237  |   0.0 |  9.30
Output  | 0.00019741 | 0.00019741 | 0.00019741 |   0.0 |  2.94
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.00016    |            |       |  2.39

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -83.8698393902314
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 1036741.73537265
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036741.73537427
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036741.73537423
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036741.73536944
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.19099061876025e-09
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 0.551591533966167
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1.78758830921586e-08

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -102975513.61715
variable C2pos equal ${d2}
variable C2pos equal -102975513.617164
variable C3pos equal ${d3}
variable C3pos equal -102975513.616669
variable C4pos equal ${d4}
variable C4pos equal 2.40702441872205e-06
variable C5pos equal ${d5}
variable C5pos equal -55.1591531534362
variable C6pos equal ${d6}
variable C6pos equal -1.66151773987186e-07

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(102975513.617149+${C1pos})
variable C15 equal 0.5*(102975513.617149+-102975513.61715)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(102975513.617164+${C2pos})
variable C25 equal 0.5*(102975513.617164+-102975513.617164)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(102975513.61667+${C3pos})
variable C35 equal 0.5*(102975513.61667+-102975513.616669)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-1.68263304932247e-06+${C4pos})
variable C45 equal 0.5*(-1.68263304932247e-06+2.40702441872205e-06)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(-55.159155601738+${C5pos})
variable C55 equal 0.5*(-55.159155601738+-55.1591531534362)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-7.72049849044449e-07+${C6pos})
variable C65 equal 0.5*(-7.72049849044449e-07+-1.66151773987186e-07)

# Delete dir to make sure it is not reused

variable dir delete
# ---- uxy Perturbation
variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 3.5507365122709

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*3.5507365122709
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -3.5507365122709e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (-3.55074e-06 -0 0)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328    6986.5992    6986.5992    6986.5992    6986.5992  -0.61906223 1.7577399e-09 6.5764639e-09    3.5507365    3.5507365    3.5507365    44.766726 
     101            0   -23.226752    107391.19    107391.19    107391.19    107391.19  -0.71197187 4.0643966e-09 1.1900297e-08    3.5507365    3.5507365    3.5507365    44.766726 
     102            0    -29.24504    293069.36    293069.36    293069.36    293069.36  -0.58594936 3.0152881e-09 8.9737046e-09    3.5507365    3.5507365    3.5507365    44.766726 
     103            0   -36.534868     565084.3     565084.3     565084.3     565084.3  -0.51261658 8.7878216e-10 4.9721844e-09    3.5507365    3.5507365    3.5507365    44.766726 
     104            0   -42.718724    859256.55    859256.55    859256.55    859256.55  -0.25142292 -1.1267473e-09 -5.2056808e-09    3.5507365    3.5507365    3.5507365    44.766726 
     105            0   -46.073904      1015433      1015433      1015433      1015433   0.96196181 -1.8057336e-08 -3.143775e-08    3.5507365    3.5507365    3.5507365    44.766726 
     106            0   -50.701339     891081.3     891081.3     891081.3     891081.3    23.774019 -5.8399749e-08 -5.3829441e-07    3.5507365    3.5507365    3.5507365    44.766726 
     107            0   -78.390195    713399.22    713399.22    713399.22    713399.22   -22.267014 1.6572591e-07 4.7294335e-07    3.5507365    3.5507365    3.5507365    44.766726 
     108            0   -83.285413      1166632      1166632      1166632      1166632   -36.665414 2.4321868e-07 7.9049601e-07    3.5507365    3.5507365    3.5507365    44.766726 
     109            0   -83.861773    1051503.3    1051503.3    1051503.3    1051503.3   -19.386919 1.2832888e-07 4.1313138e-07    3.5507365    3.5507365    3.5507365    44.766726 
     110            0   -83.869548    1039534.6    1039534.6    1039534.6    1039534.6   -11.665292 8.0999652e-08 2.3906802e-07    3.5507365    3.5507365    3.5507365    44.766726 
     111            0   -83.869796    1037813.6    1037813.6    1037813.6    1037813.6   -8.2350492 5.2352688e-08 1.6735468e-07    3.5507365    3.5507365    3.5507365    44.766726 
     112            0   -83.869837      1037019      1037019      1037019      1037019   -5.3849506 3.3859963e-08 1.1020446e-07    3.5507365    3.5507365    3.5507365    44.766726 
     113            0   -83.869837    1036970.7    1036970.7    1036970.7    1036970.7   -4.9637279 3.0744584e-08 9.4042103e-08    3.5507365    3.5507365    3.5507365    44.766726 
     114            0   -83.869838    1036897.5    1036897.5    1036897.5    1036897.5   -4.2579086 3.4914917e-08 7.9672082e-08    3.5507365    3.5507365    3.5507365    44.766726 
     115            0   -83.869839    1036813.4    1036813.4    1036813.4    1036813.4    -3.257206 1.699197e-08 6.6527119e-08    3.5507365    3.5507365    3.5507365    44.766726 
     116            0   -83.869839    1036701.2    1036701.2    1036701.2    1036701.2   -1.1387578 5.6092006e-09 9.9043537e-09    3.5507365    3.5507365    3.5507365    44.766726 
     117            0   -83.869839    1036731.6    1036731.6    1036731.6    1036731.6  -0.91879472 -1.053768e-10 3.1733016e-09    3.5507365    3.5507365    3.5507365    44.766726 
     118            0   -83.869839    1036741.1    1036741.1    1036741.1    1036741.1  -0.74744936 4.7339739e-09 1.1003314e-08    3.5507365    3.5507365    3.5507365    44.766726 
     119            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.8    -0.647418 1.4742971e-09 8.0130984e-09    3.5507365    3.5507365    3.5507365    44.766726 
     120            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7  -0.55206319 -3.2090924e-09 -2.4912892e-09    3.5507365    3.5507365    3.5507365    44.766726 
     121            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7  -0.55157772 -2.4070095e-09 -7.4654736e-10    3.5507365    3.5507365    3.5507365    44.766726 
     122            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7   -0.5516033 9.684772e-09 5.3721374e-09    3.5507365    3.5507365    3.5507365    44.766726 
     123            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7  -0.55159417 -2.2072679e-10 -8.597976e-09    3.5507365    3.5507365    3.5507365    44.766726 
     124            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7   -0.5515927 -1.2627763e-10 -8.7204539e-09    3.5507365    3.5507365    3.5507365    44.766726 
     125            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7  -0.55159153 -1.6077011e-11 3.3853311e-09    3.5507365    3.5507365    3.5507365    44.766726 
Loop time of 0.00763512 on 1 procs for 25 steps with 4 atoms

87.8% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543278079     -83.8698393902     -83.8698393902
  Force two-norm initial, final = 7.1552 8.10434e-11
  Force max component initial, final = 2.06553 3.05423e-11
  Final line search alpha, max atom move = 1 3.05423e-11
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0065348  | 0.0065348  | 0.0065348  |   0.0 | 85.59
Neigh   | 9.5844e-05 | 9.5844e-05 | 9.5844e-05 |   0.0 |  1.26
Comm    | 0.00062752 | 0.00062752 | 0.00062752 |   0.0 |  8.22
Output  | 0.00022268 | 0.00022268 | 0.00022268 |   0.0 |  2.92
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001543  |            |       |  2.02

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036741.73537427
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036741.73537176
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036741.73537194
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -0.551591525291942
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1.60770108753824e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 3.38533113681411e-09

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 102975513.61715
variable C2neg equal ${d2}
variable C2neg equal 102975513.616917
variable C3neg equal ${d3}
variable C3neg equal 102975513.616919
variable C4neg equal ${d4}
variable C4neg equal -2.80902995824781e-07
variable C5neg equal ${d5}
variable C5neg equal -2.4478818750865e-07
variable C6neg equal ${d6}
variable C6neg equal -55.1591522439434

# Reset box and simulation parameters

clear
read_restart restart.equil remap
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (0 -0 0)
  1 by 1 by 1 MPI processor grid
  4 atoms
include potential.mod
mass 1 58.6934

group Ni type 1
4 atoms in group Ni

pair_style eam/alloy
pair_coeff * * /home/sullberg/repos/pypospack/examples/Ni__eam__born_exp_rose/01_preconditioning_3.5NN/rank_8/Ni_fcc.lmps_elastic/Ni.eam.alloy Ni

neighbor 1.0 bin
neigh_modify every 1 delay 0 check yes
thermo	1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*3.5507365122709
if "${dir} == 1" then    "change_box all x delta 0 ${delta} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 3.5507365122709e-06 remap units box
  triclinic box = (-0.0170183 -0.0170183 -0.0170183) to (3.53372 3.53372 3.53372) with tilt (3.55074e-06 -0 0)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100 ${maxeval}
minimize 0 1e-10 100 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 1 1 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.182 | 4.182 | 4.182 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     100            0   -19.554328    6986.5992    6986.5992    6986.5992    6986.5992   0.61906222 9.7372551e-10 6.3977499e-09    3.5507365    3.5507365    3.5507365    44.766726 
     101            0   -23.226752    107391.19    107391.19    107391.19    107391.19   0.71197186 3.4693608e-09 1.2059459e-08    3.5507365    3.5507365    3.5507365    44.766726 
     102            0    -29.24504    293069.36    293069.36    293069.36    293069.36   0.58594935 2.839833e-09 9.3135994e-09    3.5507365    3.5507365    3.5507365    44.766726 
     103            0   -36.534868     565084.3     565084.3     565084.3     565084.3   0.51261658 2.7349891e-09 5.4357484e-09    3.5507365    3.5507365    3.5507365    44.766726 
     104            0   -42.718724    859256.55    859256.55    859256.55    859256.55   0.25142293 -8.4586579e-10 -3.4511516e-10    3.5507365    3.5507365    3.5507365    44.766726 
     105            0   -46.073904      1015433      1015433      1015433      1015433  -0.96196182 -4.3141828e-09 -2.8249502e-08    3.5507365    3.5507365    3.5507365    44.766726 
     106            0   -50.701339     891081.3     891081.3     891081.3     891081.3   -23.774018 -2.131666e-07 -5.8642267e-07    3.5507365    3.5507365    3.5507365    44.766726 
     107            0   -78.390195    713399.22    713399.22    713399.22    713399.22    22.267014 9.1894378e-08 4.6887035e-07    3.5507365    3.5507365    3.5507365    44.766726 
     108            0   -83.285413      1166632      1166632      1166632      1166632    36.665414 1.8019684e-07 7.9279839e-07    3.5507365    3.5507365    3.5507365    44.766726 
     109            0   -83.861773    1051503.3    1051503.3    1051503.3    1051503.3    19.386919 9.5897332e-08 4.0812348e-07    3.5507365    3.5507365    3.5507365    44.766726 
     110            0   -83.869548    1039534.6    1039534.6    1039534.6    1039534.6    11.665291 4.4248262e-08 2.4029826e-07    3.5507365    3.5507365    3.5507365    44.766726 
     111            0   -83.869796    1037813.6    1037813.6    1037813.6    1037813.6    8.2350492 4.0063013e-08 1.6493118e-07    3.5507365    3.5507365    3.5507365    44.766726 
     112            0   -83.869837      1037019      1037019      1037019      1037019    5.3849506 2.7980441e-08 1.0614699e-07    3.5507365    3.5507365    3.5507365    44.766726 
     113            0   -83.869837    1036970.7    1036970.7    1036970.7    1036970.7    4.9637279 2.9268753e-08 9.7911063e-08    3.5507365    3.5507365    3.5507365    44.766726 
     114            0   -83.869838    1036897.5    1036897.5    1036897.5    1036897.5    4.2579086 1.9347757e-08 7.5698935e-08    3.5507365    3.5507365    3.5507365    44.766726 
     115            0   -83.869839    1036813.4    1036813.4    1036813.4    1036813.4     3.257206 1.8672498e-08 5.8752688e-08    3.5507365    3.5507365    3.5507365    44.766726 
     116            0   -83.869839    1036701.2    1036701.2    1036701.2    1036701.2    1.1387578 -5.8381814e-10 3.8200795e-09    3.5507365    3.5507365    3.5507365    44.766726 
     117            0   -83.869839    1036731.6    1036731.6    1036731.6    1036731.6   0.91879471 -2.9603829e-09 1.087281e-08    3.5507365    3.5507365    3.5507365    44.766726 
     118            0   -83.869839    1036741.1    1036741.1    1036741.1    1036741.1   0.74744936 9.2418592e-09 3.8788125e-09    3.5507365    3.5507365    3.5507365    44.766726 
     119            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.8     0.647418 -3.3828956e-09 -4.5232279e-09    3.5507365    3.5507365    3.5507365    44.766726 
     120            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7   0.55206319 -6.3730391e-09 1.0866273e-08    3.5507365    3.5507365    3.5507365    44.766726 
     121            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7   0.55157773 -4.6321928e-09 5.3956709e-09    3.5507365    3.5507365    3.5507365    44.766726 
     122            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7   0.55160329 1.4556034e-08 -4.7193467e-09    3.5507365    3.5507365    3.5507365    44.766726 
     123            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7   0.55159421 -2.2522028e-09 -1.9132276e-09    3.5507365    3.5507365    3.5507365    44.766726 
     124            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7   0.55159271 2.0477497e-09 -3.4765256e-09    3.5507365    3.5507365    3.5507365    44.766726 
     125            0   -83.869839    1036741.7    1036741.7    1036741.7    1036741.7   0.55159153 1.6526594e-10 5.8699019e-09    3.5507365    3.5507365    3.5507365    44.766726 
Loop time of 0.020792 on 1 procs for 25 steps with 4 atoms

32.5% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -19.5543278079     -83.8698393902     -83.8698393902
  Force two-norm initial, final = 7.1552 8.3079e-11
  Force max component initial, final = 2.06553 3.21509e-11
  Final line search alpha, max atom move = 1 3.21509e-11
  Iterations, force evaluations = 25 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.019717   | 0.019717   | 0.019717   |   0.0 | 94.83
Neigh   | 9.4175e-05 | 9.4175e-05 | 9.4175e-05 |   0.0 |  0.45
Comm    | 0.00062466 | 0.00062466 | 0.00062466 |   0.0 |  3.00
Output  | 0.00020671 | 0.00020671 | 0.00020671 |   0.0 |  0.99
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001495  |            |       |  0.72

Nlocal:    4 ave 4 max 4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1368 ave 1368 max 1368 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1006 ave 1006 max 1006 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1006
Ave neighs/atom = 251.5
Neighbor list builds = 2
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -83.869839390232
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 1036741.73537266
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1036741.73537427
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1036741.73537175
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1036741.73537195
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 0.551591530578848
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1.65265937329556e-10
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 5.86990187932469e-09

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -102975513.61715
variable C2pos equal ${d2}
variable C2pos equal -102975513.616916
variable C3pos equal ${d3}
variable C3pos equal -102975513.61692
variable C4pos equal ${d4}
variable C4pos equal 3.2445921573723e-08
variable C5pos equal ${d5}
variable C5pos equal 2.26653892688156e-07
variable C6pos equal ${d6}
variable C6pos equal -55.1591533431356

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(102975513.61715+${C1pos})
variable C16 equal 0.5*(102975513.61715+-102975513.61715)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(102975513.616917+${C2pos})
variable C26 equal 0.5*(102975513.616917+-102975513.616916)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(102975513.616919+${C3pos})
variable C36 equal 0.5*(102975513.616919+-102975513.61692)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-2.80902995824781e-07+${C4pos})
variable C46 equal 0.5*(-2.80902995824781e-07+3.2445921573723e-08)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-2.4478818750865e-07+${C5pos})
variable C56 equal 0.5*(-2.4478818750865e-07+2.26653892688156e-07)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-55.1591522439434+${C6pos})
variable C66 equal 0.5*(-55.1591522439434+-55.1591533431356)

# Delete dir to make sure it is not reused

variable dir delete

# ---- Output final values
variable C11all equal ${C11}
variable C11all equal 628.269690997899
variable C22all equal ${C22}
variable C22all equal 628.269689500332
variable C33all equal ${C33}
variable C33all equal 628.269691504538
variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(152.209524996579+${C21})
variable C12all equal 0.5*(152.209524996579+152.209526501596)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(152.209525503218+${C31})
variable C13all equal 0.5*(152.209525503218+152.209526002407)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(152.209525503218+${C32})
variable C23all equal 0.5*(152.209525503218+152.209525503218)
variable C44all equal ${C44}
variable C44all equal -55.1591536692658
variable C55all equal ${C55}
variable C55all equal -55.1591543775871
variable C66all equal ${C66}
variable C66all equal -55.1591527935395
variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-4.99188899993896e-07+${C41})
variable C14all equal 0.5*(-4.99188899993896e-07+-6.9580875131467e-08)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-4.99188899993896e-07+${C51})
variable C15all equal 0.5*(-4.99188899993896e-07+-4.89100138949907e-07)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(0+${C61})
variable C16all equal 0.5*(0+-9.01973393803992e-07)
variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-9.98377799987793e-07+${C42})
variable C24all equal 0.5*(-9.98377799987793e-07+4.17284716685705e-07)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(0+${C52})
variable C25all equal 0.5*(0+-2.42764035646601e-07)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(4.99188899993896e-07+${C62})
variable C26all equal 0.5*(4.99188899993896e-07+-1.62154877720851e-07)
variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-4.99188899993896e-07+${C43})
variable C34all equal 0.5*(-4.99188899993896e-07+6.23897218507957e-07)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(4.99188899993896e-07+${C53})
variable C35all equal 0.5*(4.99188899993896e-07+-5.03571245036601e-09)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-4.99188899993896e-07+${C63})
variable C36all equal 0.5*(-4.99188899993896e-07+-1.00756316248311e-06)
variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(3.6219568469979e-07+${C54})
variable C45all equal 0.5*(3.6219568469979e-07+6.78374620011345e-08)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-1.24228537125529e-07+${C64})
variable C46all equal 0.5*(-1.24228537125529e-07+-6.96262744523199e-09)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-9.067147410247e-09+${C65})
variable C56all equal 0.5*(-9.067147410247e-09+-4.69100811515818e-07)

print "c11 = ${C11all} ${cunits}"
c11 = 628.269690997899 GPa
print "c22 = ${C22all} ${cunits}"
c22 = 628.269689500332 GPa
print "c33 = ${C33all} ${cunits}"
c33 = 628.269691504538 GPa
print "c12 = ${C12all} ${cunits}"
c12 = 152.209525749088 GPa
print "c13 = ${C13all} ${cunits}"
c13 = 152.209525752813 GPa
print "c23 = ${C23all} ${cunits}"
c23 = 152.209525503218 GPa
print "c44 = ${C44all} ${cunits}"
c44 = -55.1591536692658 GPa
print "c55 = ${C55all} ${cunits}"
c55 = -55.1591543775871 GPa
print "c66 = ${C66all} ${cunits}"
c66 = -55.1591527935395 GPa
print "c14 = ${C14all} ${cunits}"
c14 = -2.84384887562681e-07 GPa
print "c15 = ${C15all} ${cunits}"
c15 = -4.94144519471901e-07 GPa
print "c16 = ${C16all} ${cunits}"
c16 = -4.50986696901996e-07 GPa
print "c24 = ${C24all} ${cunits}"
c24 = -2.90546541651044e-07 GPa
print "c25 = ${C25all} ${cunits}"
c25 = -1.213820178233e-07 GPa
print "c26 = ${C26all} ${cunits}"
c26 = 1.68517011136522e-07 GPa
print "c34 = ${C34all} ${cunits}"
c34 = 6.23541592570305e-08 GPa
print "c35 = ${C35all} ${cunits}"
c35 = 2.47076593771765e-07 GPa
print "c36 = ${C36all} ${cunits}"
c36 = -7.53376031238503e-07 GPa
print "c45 = ${C45all} ${cunits}"
c45 = 2.15016573350462e-07 GPa
print "c46 = ${C46all} ${cunits}"
c46 = -6.55955822853805e-08 GPa
print "c56 = ${C56all} ${cunits}"
c56 = -2.39083979463032e-07 GPa
print "lammps_sim_done"
lammps_sim_done
Total wall time: 0:00:00
